<!DOCTYPE html>
<html data-html-server-rendered="true" lang="en" class="h-full" data-vue-tag="%7B%22lang%22:%7B%22ssr%22:%22en%22%7D,%22class%22:%7B%22ssr%22:%22h-full%22%7D%7D">
  <head>
    <title>Cegah XSS dengan Content-Security-Policy </title><meta name="gridsome:hash" content="b0048d7470397959ff747340f2454df5aa79024a"><meta data-vue-tag="ssr" charset="utf-8"><meta data-vue-tag="ssr" name="generator" content="Gridsome v0.7.9"><meta data-vue-tag="ssr" data-key="viewport" name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"><meta data-vue-tag="ssr" data-key="format-detection" name="format-detection" content="telephone=no"><meta data-vue-tag="ssr" name="theme-color" content="#1a202c"><meta data-vue-tag="ssr" data-key="description" name="description" content="Gunakan CSP untuk mencegah browser eksekusi script dari sumber yang tidak diinginkan"><meta data-vue-tag="ssr" property="og:type" content="article"><meta data-vue-tag="ssr" property="og:title" content="Cegah XSS dengan Content-Security-Policy"><meta data-vue-tag="ssr" property="og:description" content="Gunakan CSP untuk mencegah browser eksekusi script dari sumber yang tidak diinginkan"><meta data-vue-tag="ssr" property="og:url" content="https://www.emsifa.com/artikel/cegah-xss-dengan-csp/"><meta data-vue-tag="ssr" property="article:published_time" content="undefined"><meta data-vue-tag="ssr" property="og:image" content="https://www.emsifa.com/images/posts/csp-cover.png"><meta data-vue-tag="ssr" name="twitter:card" content="summary_large_image"><meta data-vue-tag="ssr" name="twitter:title" content="Cegah XSS dengan Content-Security-Policy"><meta data-vue-tag="ssr" name="twitter:description" content="Gunakan CSP untuk mencegah browser eksekusi script dari sumber yang tidak diinginkan"><meta data-vue-tag="ssr" name="twitter:site" content="@cossssmin"><meta data-vue-tag="ssr" name="twitter:creator" content="@cossssmin"><meta data-vue-tag="ssr" name="twitter:image" content="/images/posts/csp-cover.png"><link data-vue-tag="ssr" rel="icon" href="data:,"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="16x16" href="/assets/static/favicon.ce0531f.74da076.png"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="32x32" href="/assets/static/favicon.ac8d93a.74da076.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="48x48" href="/assets/static/favicon.f8b3168.74da076.png"><link rel="preload" href="/assets/css/9.styles.f41d542c.css" as="style"><link rel="preload" href="/assets/js/app.649ec608.js" as="script"><link rel="preload" href="/assets/js/page--src-templates-post-vue.b802386a.js" as="script"><link rel="prefetch" href="/assets/js/11.dcc21600.js"><link rel="prefetch" href="/assets/js/page--src-pages-404-vue.c2a4eab9.js"><link rel="prefetch" href="/assets/js/page--src-pages-artikel-vue.e5f192dc.js"><link rel="prefetch" href="/assets/js/page--src-pages-index-vue.f0f7ad7e.js"><link rel="prefetch" href="/assets/js/page--src-pages-open-sources-vue.6ba366a8.js"><link rel="prefetch" href="/assets/js/page--src-templates-author-vue.d4a8aaa2.js"><link rel="prefetch" href="/assets/js/page--src-templates-tag-vue.8b1b260a.js"><link rel="prefetch" href="/assets/js/vendors~page--src-pages-artikel-vue~page--src-pages-index-vue~page--src-pages-open-sources-vue~page-~f457dff2.670b1997.js"><link rel="prefetch" href="/assets/js/vendors~page--src-templates-post-vue.e1081558.js"><link rel="stylesheet" href="/assets/css/9.styles.f41d542c.css"><noscript data-vue-tag="ssr"><style>.g-image--loading{display:none;}</style></noscript>
  </head>
  <body class="antialiased" data-vue-tag="%7B%22class%22:%7B%22ssr%22:%22antialiased%22%7D%7D">
    <div data-server-rendered="true" id="app" class="min-h-screen light"><header class="select-none mb-5 shadow-lg border-gray-200" data-v-1b58b763><div class="container max-w-3xl px-5 md:px-0 py-5" data-v-1b58b763><div class="flex" data-v-1b58b763><div class="w-10/12" data-v-1b58b763><a href="/" class="text-black w-full inline-block active" data-v-1b58b763><div class="flex" data-v-1b58b763><div class="w-auto" data-v-1b58b763><img src="/images/logo.svg" alt="Logo" class="inline" data-v-1b58b763></div><div class="w-auto ml-3 pt-2" data-v-1b58b763><h1 class="text-normal font-semibold text-gray-700" data-v-1b58b763>
                Webnya Muhammad Syifa
              </h1><h2 class="text-sm text-gray-700 text-gray-700" data-v-1b58b763>
                Ini halaman artikel
              </h2></div></div></a></div><div class="w-2/12 text-right pt-3" data-v-1b58b763><button title="Gelapin" class="
            p-2
            rounded-full
            bg-transparent
            transition-all
            focus:outline-none
           hover:bg-yellow-200" data-v-1b58b763><img src="/images/sun.svg" alt="Sun" style="width:30px;height:30px;" data-v-1b58b763><!----></button></div></div></div></header><main><header><div class="container max-w-3xl px-5 md:px-0"><div class="mx-auto pb-5 border-b border-gray-200 text-gray-700"><img alt="Cegah XSS dengan Content-Security-Policy" src="/images/posts/csp-cover.png" class="g-image"><h1 class="text-3xl sm:text-3xl leading-tight font-sans font-semibold mb-3 mt-5">
        Cegah XSS dengan Content-Security-Policy
      </h1><p class="text-sm"><time datetime="2020-01-24 11:00:00" class="capitalize">24 Januari 2020</time></p><p class="text-xs mt-2 uppercase"></p><div class="tags mt-5"><a href="/tag/Web/" class="
          inline-block
          font-sans
          font-semibold
          text-xs
          sm:text-sm
          px-2
          py-1
          mr-2
          mb-2
          rounded
          transition-color
          transition-bg
         text-gray-700 bg-gray-200 hover:text-white hover:bg-gray-700">
          Web
        </a><a href="/tag/XSS/" class="
          inline-block
          font-sans
          font-semibold
          text-xs
          sm:text-sm
          px-2
          py-1
          mr-2
          mb-2
          rounded
          transition-color
          transition-bg
         text-gray-700 bg-gray-200 hover:text-white hover:bg-gray-700">
          XSS
        </a></div></div></div></header><div class="container max-w-3xl px-5 md:px-0"><article class="pt-5 border-grey-200"><div class="markdown text-lg leading-normal text-gray-700 pb-10"><p>Kemarin lusa (1/22), saya menerima laporan dari admin website kementerian yang saya buat kalau
webnya mengalami kendala hanya menampilkan <em>preloader</em> saja. Setelah saya cek melalui <em>devtools browser</em>,
pada bagian console, saya mendapati kalau <em>browser</em> tidak diizinkan untuk me-<em>load</em> <em>javascript</em>, <em>css</em>, maupun <em>font</em> yang berasal
dari <a href="https://cdnjs.com" target="_blank" rel="nofollow noopener noreferrer">https://cdnjs.com</a> dan <a href="https://unpkg.com" target="_blank" rel="nofollow noopener noreferrer">https://unpkg.com</a>. Alhasil sebagian script yang dibutuhkan
tidak di-<em>load</em>, yaudah, rusak deh. Kurang lebih penampakan errornya (di Firefox) kayak gini:</p>
<p><img src="/images/posts/ss-csp-error.png" alt="CSP Error"></p>
<p>Ternyata sebelumnya dari pihak IT pusat sana, web servernya baru disetting untuk mengirimkan <em>header</em> <code>Content-Security-Policy</code> yang berisikan <em>whitelist</em> <em>host</em> mana saja yang diperbolehkan untuk di-<em>load</em> oleh website-website yang berada pada server naungan mereka, dan <em>cdnjs.cloudflare.com</em> serta <em>unpkg.com</em> tidak terdaftar dalam <em>whitelist</em> tersebut. Karena saya cuma dikasih akses ke sebagian fitur <em>cpanel</em>-nya aja, alhasil yang saya lakukan adalah mengunduh semua <em>resource</em> pada <em>CDN</em>, dan mengunggahnya ke server mereka, lalu mengubah kode <em>HTML</em> dari yang tadinya load ke <em>URL</em> <em>CDN</em> menjadi load ke <em>URL</em> website itu sendiri.</p>
<p>Apa yang dilakukan IT pihak pusat memang sudah benar, yaitu mencegah potensi <em>XSS</em> dari berbagai website yang dikembangkan berbagai developer (dan vendor) yang hosting websitenya ke server mereka, dimana jika ada salah satu website saja <em>vuln</em>, maka website lain bisa terpengaruh karenanya.</p>
<p>Setelah kejadian ini saya baca-baca lagi tentang <strong><em>Content-Security-Policy (CSP)</em></strong>, dan <del>supaya menjadi manfaat</del> karena blog saya udah lama ga update, saya tulis sekalian disini.</p>
<blockquote>
<p>Setelah ini saya akan singkat <strong><em>Content-Security-Policy</em></strong> menjadi <strong><em>CSP</em></strong> saja.</p>
</blockquote>
<h2 id="apa-itu-csp"><a href="#apa-itu-csp" aria-hidden="true"><span class="icon icon-link"></span></a>Apa itu <em>CSP</em>?</h2>
<p><em>CSP</em> adalah <em>HTTP Response Header</em> atau <em>Meta Tag</em> untuk mengatur <strong>resource dari sumber mana saja</strong>
yang diperbolehkan untuk dieksekusi oleh <em>web browser</em> (yang <a href="https://caniuse.com/#search=CSP" target="_blank" rel="nofollow noopener noreferrer">mendukung <em>CSP</em></a> tentunya).</p>
<p>Yang dimaksud <em>resource</em> disini itu ya <a href="https://en.wikipedia.org/wiki/Web_resource" target="_blank" rel="nofollow noopener noreferrer"><em>web resource</em></a>, seperti <em>javascript</em>, <em>css</em>, <em>font</em>, <em>image</em>, <em>video</em>, <em>audio</em>, dsb.</p>
<p>Dengan <em>CSP</em> kita dapat meminimalisir potensi-potensi serangan XSS pada website kita dengan memerintahkan <em>browser</em> untuk jangan me-<em>load</em> dan mengeksekusi <em>resource</em> dari sumber yang tidak kita inginkan.</p>
<h2 id="apa-yang-bisa-kita-lakukan-dengan-csp"><a href="#apa-yang-bisa-kita-lakukan-dengan-csp" aria-hidden="true"><span class="icon icon-link"></span></a>Apa yang bisa kita lakukan dengan <em>CSP</em>?</h2>
<p>Dengan memberikan <em>CSP</em> ke halaman web kamu, kamu dapat:</p>
<ul>
<li>Mencegah <em>browser</em> untuk mengeksekusi <em>inline script</em> (<em>javascript</em> di <em>HTML</em>).</li>
<li>Mencegah <em>browser</em> untuk mengeksekusi <code>eval</code>.</li>
<li>Mencegah <em>browser</em> untuk mengeksekusi <em>inline style</em>.</li>
<li>Mencegah <em>browser</em> untuk mengeksekusi <em>script</em>, <em>css</em>, <em>font</em>, gambar, video, suara, dsb diluar host yang kita tentukan.</li>
<li>Mencegah <em>browser</em> untuk submisi form yang <code>action</code>-nya menuju ke host yang tidak kita daftarkan.</li>
<li>Mencegah <em>browser</em> untuk menjalankan <em>Ajax</em>, maupun <em>WebSocket</em> diluar host yang kita tentukan.</li>
<li>dll.</li>
</ul>
<h2 id="bagaimana-csp-dapat-mencegah-xss"><a href="#bagaimana-csp-dapat-mencegah-xss" aria-hidden="true"><span class="icon icon-link"></span></a>Bagaimana <em>CSP</em> dapat Mencegah <em>XSS</em>?</h2>
<p>Serangan <em>XSS</em> umumnya berasal dari form yang disubmit oleh user, yang kemudian isian dari form tersebut di-<em>render</em> ke user lain sebagai kode <em>HTML</em> (tidak di-<em>escaping</em>).</p>
<p>Contoh sederhananya adalah form komentar. Misalkan ada user user memasukkan kode <code>&#x3C;script>alert('oi')&#x3C;/script></code> pada kolom komentar,  dan <em>server-side</em> tidak melakukan <em>escaping</em> terhadap komentar tersebut, yang terjadi adalah <em>browser</em> akan mengeksekusi <em>inline script</em> tersebut untuk menampilkan <em>alert</em> ke semua user.</p>
<p>Dengan <em>CSP</em>, kita dapat menghindari hal ini dengan cara memerintahkan browser untuk jangan eksekusi <em>inline script</em> melalui <em>response header</em> ataupun <em>meta tag</em>. Jadi sekalipun developer khilaf tidak melakukan <em>escaping</em>, serangan <em>XSS</em> dapat dihindari.</p>
<h2 id="penulisan-csp"><a href="#penulisan-csp" aria-hidden="true"><span class="icon icon-link"></span></a>Penulisan <em>CSP</em></h2>
<p>Seperti yang sudah saya bilang sebelumnya, <em>CSP</em> dapat kita tuliskan pada <em>response header</em>, ataupun <em>meta tag</em>.
Hanya saja, artikel yang saya baca di halaman <a href="https://developers.google.com/web/fundamentals/security/csp#the_meta_tag" target="_blank" rel="nofollow noopener noreferrer">Google Developers</a> lebih menyarankan menggunakan <em>response header</em>. Jadi disini saya akan mencontohkan menggunakan <em>response header</em> saja.</p>
<p>Untuk penulisan <em>header CSP</em>, formatnya adalah sebagai berikut:</p>
<code class="shiki" style="background: #2e3440; color: #d8dee9">Content-Security-Policy: &lt;policy-directive-1&gt;; &lt;policy-directive-2&gt;; &lt;policy-directive-n&gt;</code>
<p>Sedangkan untuk penulisan <code>&#x3C;policy-directive></code> formatnya adalah seperti ini:</p>
<code class="shiki" style="background: #2e3440; color: #d8dee9">&lt;directive-a&gt; &lt;source-1&gt; &lt;source-2&gt; &lt;source-n&gt;</code>
<p>Sebagai contoh, jika kita hanya memperbolehkan <em>load</em> <em>script</em> dan <em>css</em> dari <code>web-a.com</code> dan <code>web-b.com</code>,
kita dapat menuliskan <em>CSP</em> seperti ini:</p>
<code class="shiki" style="background: #2e3440; color: #d8dee9">Content-Security-Policy: script-src https://web-a.com https://web-b.com; style-src https://web-a.com https://web-b.com</code>
<p>Pada contoh diatas kita menggunakan <em>directive</em> <code>script-src</code> dan <code>style-src</code>.
Dibawah ini adalah daftar beberapa <em>directive</em> yang dapat kamu gunakan:</p>
<ul>
<li><code>connect-src</code>: membatasi akses ajax (<em>XMLHttpRequest</em>), <em>WebSocket</em>, dan <em>EventSource</em>.</li>
<li><code>font-src</code>: membatasi akses font.</li>
<li><code>img-src</code>: membatasi akses image.</li>
<li><code>script-src</code>: membatasi akses script.</li>
<li><code>style-src</code>: membatasi akses style (css).</li>
<li><code>media-src</code>: membatasi akses video dan audio.</li>
<li><code>worker-src</code>: membatasi akses service worker.</li>
<li><code>child-src</code>: membatasi akses iframe dan worker.</li>
<li><code>form-action</code>: membatasi <code>action</code> dari form.</li>
<li><code>default-src</code>: kalau kamu malas jabarkan satu-persatu, kamu bisa gunakan ini untuk membatasi semua hal diatas.</li>
</ul>
<p>Daftar diatas bisa saja bertambah atau berubah suatu saat, untuk itu, selebihnya bisa kamu pelajari sendiri pada artikel <a href="https://developers.google.com/web/fundamentals/security/csp#policy_applies_to_a_wide_variety_of_resources" target="_blank" rel="nofollow noopener noreferrer"><em>CSP</em> di Google Developers</a> atau panduan <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy#Directives" target="_blank" rel="nofollow noopener noreferrer"><em>CSP</em> di MDN</a>.</p>
<p>Selanjutnya, selain mendaftarkan <em>host</em> apa saja yang diperbolehkan, <em>CSP</em> juga memiliki beberapa keyword yang dapat kamu gunakan sebagai <code>&#x3C;source></code> seperti dibawah ini:</p>
<ul>
<li><code>'self'</code>: untuk memperbolehkan <em>browser</em> load resource dari domain yang sama dengan website di-<em>load</em>.</li>
<li><code>'unsafe-inline'</code>: untuk memperbolehkan <em>browser</em> mengeksekusi <em>inline script</em> ataupun <em>inline style</em>.</li>
<li><code>'unsafe-eval'</code>: untuk memperbolehkan <em>browser</em> mengeksekusi fungsi javascript <code>eval</code>.</li>
<li><code>'none'</code>: jika kamu tidak memperbolehkan <em>browser</em> load resource dari sumber manapun.</li>
</ul>
<blockquote>
<p>Keyword diatas harus kamu tulis dengan menyertakan tanda petik tunggal.</p>
</blockquote>
<h2 id="contoh-penerapan-csp"><a href="#contoh-penerapan-csp" aria-hidden="true"><span class="icon icon-link"></span></a>Contoh Penerapan <em>CSP</em></h2>
<p>Pada bagian ini saya menuliskan contoh-contoh <em>CSP</em> umum yang mungkin banyak orang butuhkan.
Disini dimisalkan saya <em>host</em> halaman-halaman contoh ini pada <code>https://www.emsifa.com</code>.</p>
<blockquote>
<p>Disini saya akan menggunakan PHP supaya lebih ringkas aja.</p>
</blockquote>
<h4 id="1-memperbolehkan-semua-jenis-resource-dari-domain-yang-sama"><a href="#1-memperbolehkan-semua-jenis-resource-dari-domain-yang-sama" aria-hidden="true"><span class="icon icon-link"></span></a>1. Memperbolehkan Semua Jenis Resource dari Domain yang Sama</h4>
<p>Dari kebutuhan diatas, kita dapat terjemahkan menjadi:</p>
<ul>
<li>Semua Jenis Resource: <code>default-src</code></li>
<li>Dari Domain yang Sama: <code>'self'</code></li>
</ul>
<p>Jadi penerapan <em>CSP</em>-nya adalah sebagai berikut:</p>
<pre class="shiki" style="background-color: #191d21"><code><span style="color: #EFEFEF">&lt;?php</span>

<span style="color: #EFEFEF">&gt;</span><span style="color: #FAC863">header</span><span style="color: #FFFFFF">(</span><span style="color: #50E3C2">"Content-Security-Policy: default-src 'self'"</span><span style="color: #FFFFFF">)</span><span style="color: #EFEFEF">;</span>

<span style="color: #EFEFEF">?&gt;</span>
<span style="color: #2BA8FF">&lt;html&gt;</span>
<span style="color: #2BA8FF">&lt;body&gt;</span>
<span style="color: #FFFFFF">  </span><span style="color: #2BA8FF">&lt;script</span><span style="color: #FFFFFF"> </span><span style="color: #FAC863">src</span><span style="color: #FFFFFF">=</span><span style="color: #50E3C2">"https://www.emsifa.com/js/app.js"</span><span style="color: #2BA8FF">&gt;&lt;/script&gt;</span>
<span style="color: #FFFFFF">  </span><span style="color: #2BA8FF">&lt;script</span><span style="color: #FFFFFF"> </span><span style="color: #FAC863">src</span><span style="color: #FFFFFF">=</span><span style="color: #50E3C2">"https://cdnjs.cloudflare.com/jquery/jquery.min.js"</span><span style="color: #2BA8FF">&gt;&lt;/script&gt;</span>
<span style="color: #FFFFFF">  </span><span style="color: #2BA8FF">&lt;script&gt;alert</span><span style="color: #FFFFFF">(</span><span style="color: #50E3C2">'hello'</span><span style="color: #FFFFFF">)</span><span style="color: #2BA8FF">&lt;/script&gt;</span>
<span style="color: #2BA8FF">&lt;/body&gt;</span>
<span style="color: #2BA8FF">&lt;/html&gt;</span></code></pre>
<p>Pada contoh diatas, script <code>app.js</code> akan di-<em>load</em> dan dieksekusi oleh browser, sedangkan script jQuery tidak akan dieksekusi karena berada pada host <code>cdnjs.cloudflare.com</code>, dan script <code>alert('hello')</code> dibawahnya juga tidak akan dieksekusi karena kita tidak mendaftarkan <code>'unsafe-inline'</code> pada header CSP.</p>
<h4 id="2-memperbolehkan-semua-jenis-resource-dari-sumber-yang-sama-dan-cdnjs"><a href="#2-memperbolehkan-semua-jenis-resource-dari-sumber-yang-sama-dan-cdnjs" aria-hidden="true"><span class="icon icon-link"></span></a>2. Memperbolehkan Semua Jenis Resource dari Sumber yang Sama dan CDN.js</h4>
<p>Dari kebutuhan diatas, kalau kita terjemahkan kedalam CSP, menjadi:</p>
<ul>
<li>Semua Jenis Resource: <code>default-src</code></li>
<li>Sumber yang sama dan CDN.js: <code>'self' https://cdnjs.cloudflare.com</code></li>
</ul>
<p>Kalau kita terapkan ke <em>CSP</em> akan menjadi:</p>
<pre class="shiki" style="background-color: #191d21"><code><span style="color: #EFEFEF">&lt;?php</span>

<span style="color: #EFEFEF">&gt;</span><span style="color: #FAC863">header</span><span style="color: #FFFFFF">(</span><span style="color: #50E3C2">"Content-Security-Policy: default-src 'self' https://cdnjs.cloudflare.com"</span><span style="color: #FFFFFF">)</span><span style="color: #EFEFEF">;</span>

<span style="color: #EFEFEF">?&gt;</span>
<span style="color: #2BA8FF">&lt;html&gt;</span>
<span style="color: #2BA8FF">&lt;body&gt;</span>
<span style="color: #FFFFFF">  </span><span style="color: #2BA8FF">&lt;script</span><span style="color: #FFFFFF"> </span><span style="color: #FAC863">src</span><span style="color: #FFFFFF">=</span><span style="color: #50E3C2">"https://www.emsifa.com/js/app.js"</span><span style="color: #2BA8FF">&gt;&lt;/script&gt;</span>
<span style="color: #FFFFFF">  </span><span style="color: #2BA8FF">&lt;script</span><span style="color: #FFFFFF"> </span><span style="color: #FAC863">src</span><span style="color: #FFFFFF">=</span><span style="color: #50E3C2">"https://cdnjs.cloudflare.com/jquery/jquery.min.js"</span><span style="color: #2BA8FF">&gt;&lt;/script&gt;</span>
<span style="color: #FFFFFF">  </span><span style="color: #2BA8FF">&lt;script&gt;alert</span><span style="color: #FFFFFF">(</span><span style="color: #50E3C2">'hello'</span><span style="color: #FFFFFF">)</span><span style="color: #2BA8FF">&lt;/script&gt;</span>
<span style="color: #2BA8FF">&lt;/body&gt;</span>
<span style="color: #2BA8FF">&lt;/html&gt;</span></code></pre>
<p>Pada contoh diatas, <code>app.js</code> dan jQuery akan di-<em>load</em> oleh <em>browser</em>, sedangkan script <code>alert('hello')</code> tetap diblokir oleh <em>browser</em>.</p>
<h4 id="3-hanya-memperbolehkan-script-css-dan-image-dari-hosting-sendiri-tidak-memperbolehkan-video-dan-audio-apapun-tapi-memperbolehkan-embed-video-youtube"><a href="#3-hanya-memperbolehkan-script-css-dan-image-dari-hosting-sendiri-tidak-memperbolehkan-video-dan-audio-apapun-tapi-memperbolehkan-embed-video-youtube" aria-hidden="true"><span class="icon icon-link"></span></a>3. Hanya Memperbolehkan <em>Script</em>, <em>CSS</em>, dan <em>Image</em> dari <em>Hosting</em> Sendiri, tidak Memperbolehkan Video dan Audio Apapun, tapi memperbolehkan Embed Video Youtube</h4>
<p>Oke, kita coba terjemahkan dulu kebutuhan diatas:</p>
<ul>
<li>Hanya Memperbolehkan Script CSS dan Image dari Hosting sendiri: artinya kita memerlukan 3 buah directive yaitu <code>script-src</code>, <code>style-src</code>, dan <code>img-src</code> yang memperbolehkan <code>'self'</code>.</li>
<li>Tidak memperbolehkan Video dan Audio Apapun: artinya kita perlu menuliskan directive <code>media-src</code> menjadi <code>'none'</code>.</li>
<li>Tapi memperbolehkan Embed Video Youtube: artinya kita perlu menuliskan directive <code>child-src</code> ke <code>https://youtube.com</code>.</li>
</ul>
<p>Kalau kita terapkan ke header <em>CSP</em> menjadi seperti ini:</p>
<pre class="shiki" style="background-color: #191d21"><code><span style="color: #EFEFEF">&lt;?php</span>

<span style="color: #EFEFEF">&gt;</span><span style="color: #FAC863">header</span><span style="color: #FFFFFF">(</span><span style="color: #50E3C2">"Content-Security-Policy: script-src 'self'; style-src 'self'; img-src: 'self'; media-src 'none'; child-src https://youtube.com"</span><span style="color: #FFFFFF">)</span><span style="color: #EFEFEF">;</span>

<span style="color: #EFEFEF">?&gt;</span>
<span style="color: #2BA8FF">&lt;html&gt;</span>
<span style="color: #2BA8FF">&lt;head&gt;</span>
<span style="color: #FFFFFF">  </span><span style="color: #2BA8FF">&lt;link</span><span style="color: #FFFFFF"> </span><span style="color: #FAC863">rel</span><span style="color: #FFFFFF">=</span><span style="color: #50E3C2">"stylesheet"</span><span style="color: #FFFFFF"> </span><span style="color: #FAC863">href</span><span style="color: #FFFFFF">=</span><span style="color: #50E3C2">"https://www.emsifa.com/css/style.css"</span><span style="color: #2BA8FF">/&gt;</span>
<span style="color: #FFFFFF">  </span><span style="color: #2BA8FF">&lt;link</span><span style="color: #FFFFFF"> </span><span style="color: #FAC863">rel</span><span style="color: #FFFFFF">=</span><span style="color: #50E3C2">"stylesheet"</span><span style="color: #FFFFFF"> </span><span style="color: #FAC863">href</span><span style="color: #FFFFFF">=</span><span style="color: #50E3C2">"https://cdnjs.cloudflare.com/bootstrap/css/bootstrap.min.css"</span><span style="color: #2BA8FF">/&gt;</span>
<span style="color: #FFFFFF">  </span><span style="color: #2BA8FF">&lt;style&gt;</span>
<span style="color: #FFFFFF">    </span><span style="color: #2BA8FF">img</span><span style="color: #FFFFFF"> </span><span style="color: #EFEFEF">{</span><span style="color: #FFFFFF"> </span><span style="color: #2BA8FF">width</span><span style="color: #FFFFFF">:</span><span style="color: #9FBDE0"> </span><span style="color: #2BA8FF">100</span><span style="color: #FF0078">px</span><span style="color: #EFEFEF">;</span><span style="color: #FFFFFF"> </span><span style="color: #EFEFEF">}</span>
<span style="color: #FFFFFF">  </span><span style="color: #2BA8FF">&lt;/style&gt;</span>
<span style="color: #2BA8FF">&lt;/head&gt;</span>
<span style="color: #2BA8FF">&lt;body&gt;</span>
<span style="color: #FFFFFF">  </span><span style="color: #2BA8FF">&lt;img</span><span style="color: #FFFFFF"> </span><span style="color: #FAC863">src</span><span style="color: #FFFFFF">=</span><span style="color: #50E3C2">"https://www.emsifa.com/img/logo.png"</span><span style="color: #2BA8FF">/&gt;</span>
<span style="color: #FFFFFF">  </span><span style="color: #2BA8FF">&lt;img</span><span style="color: #FFFFFF"> </span><span style="color: #FAC863">src</span><span style="color: #FFFFFF">=</span><span style="color: #50E3C2">"https://www.w3schools.com/img/logo.png"</span><span style="color: #2BA8FF">/&gt;</span>

<span style="color: #FFFFFF">  </span><span style="color: #2BA8FF">&lt;iframe</span><span style="color: #FFFFFF"> </span><span style="color: #FAC863">width</span><span style="color: #FFFFFF">=</span><span style="color: #50E3C2">"560"</span><span style="color: #FFFFFF"> </span><span style="color: #FAC863">height</span><span style="color: #FFFFFF">=</span><span style="color: #50E3C2">"315"</span><span style="color: #FFFFFF"> </span><span style="color: #FAC863">src</span><span style="color: #FFFFFF">=</span><span style="color: #50E3C2">"https://www.youtube.com/embed/pTGRpH2dvRM"</span><span style="color: #FFFFFF"> </span><span style="color: #FAC863">frameborder</span><span style="color: #FFFFFF">=</span><span style="color: #50E3C2">"0"</span><span style="color: #FFFFFF"> </span><span style="color: #FAC863">allow</span><span style="color: #FFFFFF">=</span><span style="color: #50E3C2">"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture"</span><span style="color: #FFFFFF"> </span><span style="color: #FAC863">allowfullscreen</span><span style="color: #2BA8FF">&gt;&lt;/iframe&gt;</span>

<span style="color: #FFFFFF">  </span><span style="color: #2BA8FF">&lt;script</span><span style="color: #FFFFFF"> </span><span style="color: #FAC863">src</span><span style="color: #FFFFFF">=</span><span style="color: #50E3C2">"https://www.emsifa.com/js/app.js"</span><span style="color: #2BA8FF">&gt;&lt;/script&gt;</span>
<span style="color: #FFFFFF">  </span><span style="color: #2BA8FF">&lt;script</span><span style="color: #FFFFFF"> </span><span style="color: #FAC863">src</span><span style="color: #FFFFFF">=</span><span style="color: #50E3C2">"https://cdnjs.cloudflare.com/jquery/jquery.min.js"</span><span style="color: #2BA8FF">&gt;&lt;/script&gt;</span>
<span style="color: #FFFFFF">  </span><span style="color: #2BA8FF">&lt;script&gt;alert</span><span style="color: #FFFFFF">(</span><span style="color: #50E3C2">'hello'</span><span style="color: #FFFFFF">)</span><span style="color: #2BA8FF">&lt;/script&gt;</span>
<span style="color: #2BA8FF">&lt;/body&gt;</span>
<span style="color: #2BA8FF">&lt;/html&gt;</span></code></pre>
<p>Dari seluruh resource pada kode HTML diatas, hasilnya adalah seperti ini:</p>
<ol>
<li>style <code>https://www.emsifa.com/css/style.css</code>: ✔.</li>
<li>style <code>https://cdnjs.cloudflare.com/bootstrap/css/bootstrap.min.css</code>: ❌.</li>
<li>inline style <code>img {width: 100px}</code>: ❌.</li>
<li>image <code>https://www.emsifa.com/img/logo.png</code>: ✔.</li>
<li>image <code>https://www.w3schools.com/img/logo.png</code>: ❌.</li>
<li>iframe <code>https://www.youtube.com/embed/pTGRpH2dvRM</code>: ✔.</li>
<li>script <code>https://www.emsifa.com/js/app.js</code>: ✔.</li>
<li>script <code>https://cdnjs.cloudflare.com/jquery/jquery.min.js</code>: ❌.</li>
<li>inline script <code>alert('hello')</code>: ❌.</li>
</ol>
<h2 id="penutup"><a href="#penutup" aria-hidden="true"><span class="icon icon-link"></span></a>Penutup</h2>
<p>Jadi seperti itulah <em>CSP</em>, bagaimana penulisannya, serta beberapa contohnya.
Artikel ini saya adaptasi dari 2 link dibawah ini:</p>
<ul>
<li><a href="https://developers.google.com/web/fundamentals/security/csp" target="_blank" rel="nofollow noopener noreferrer">https://developers.google.com/web/fundamentals/security/csp</a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy" target="_blank" rel="nofollow noopener noreferrer">https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy</a></li>
</ul>
<p>Yaudah, sekian dulu artikel kali ini. Semoga bermanfaat, dah ~ </p>
</div></article></div><section class="mb-10 py-16 bg-gray-200 text-gray-700"><div class="container max-w-3xl px-5 md:px-0"><div class="flex"><div class="w-10/12 mx-auto"><h4 class="text-2xl font-semibold mb-4 -mt-4">Suka artikel ini?</h4><p class="mb-8">
          Saya biasanya share artikel-artikel terbaru via
          <strong class="text-gray-700">facebook</strong> atau <strong class="text-gray-700">fanpage foobarology</strong> saya.
          Kalau mau dapat updatenya, di add friend/like/follow aja link-link dibawah ini 😃
        </p><a target="_blank" rel="noopener" href="https://www.facebook.com/em.sifa" class="px-4 py-2 text-lg text-white bg-gray-600 hover:bg-blue-500 rounded">
          Facebook
        </a><a target="_blank" rel="noopener" href="https://www.facebook.com/foobarology" class="ml-3 px-4 py-2 text-lg text-white bg-gray-600 hover:bg-blue-500 rounded">
          Foobarology
        </a></div></div></div></section><footer class="text-gray-700 text-sm leading-normal flex flex-wrap justify-between mx-auto max-w-3xl px-6 sm:px-12 pb-8 sm:pb-10"><div class="w-full sm:w-1/2 mb-4 sm:mb-0 text-gray-700"><p>© 2019</p></div><div class="w-full sm:w-1/2"><nav><ul class="flex sm:justify-end -mx-2"><li class="px-2"><a href="/" class="text-gray-700 border-b border-transparent hover:border-gray-400 transition-border-color active">Home</a></li><li class="px-2"><a href="/sitemap.xml" class="text-gray-700 border-b border-transparent hover:border-gray-400 transition-border-color">Sitemap</a></li><li class="px-2"><a href="/feed.xml" class="text-gray-700 border-b border-transparent hover:border-gray-400 transition-border-color">RSS Feed</a></li></ul></nav></div></footer></main></div>
    <script>window.__INITIAL_STATE__={"data":{"post":{"title":"Cegah XSS dengan Content-Security-Policy","slug":"cegah-xss-dengan-csp","datetime":"2020-01-24 11:00:00","content":"\u003Cp\u003EKemarin lusa (1\u002F22), saya menerima laporan dari admin website kementerian yang saya buat kalau\nwebnya mengalami kendala hanya menampilkan \u003Cem\u003Epreloader\u003C\u002Fem\u003E saja. Setelah saya cek melalui \u003Cem\u003Edevtools browser\u003C\u002Fem\u003E,\npada bagian console, saya mendapati kalau \u003Cem\u003Ebrowser\u003C\u002Fem\u003E tidak diizinkan untuk me-\u003Cem\u003Eload\u003C\u002Fem\u003E \u003Cem\u003Ejavascript\u003C\u002Fem\u003E, \u003Cem\u003Ecss\u003C\u002Fem\u003E, maupun \u003Cem\u003Efont\u003C\u002Fem\u003E yang berasal\ndari \u003Ca href=\"https:\u002F\u002Fcdnjs.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003Ehttps:\u002F\u002Fcdnjs.com\u003C\u002Fa\u003E dan \u003Ca href=\"https:\u002F\u002Funpkg.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003Ehttps:\u002F\u002Funpkg.com\u003C\u002Fa\u003E. Alhasil sebagian script yang dibutuhkan\ntidak di-\u003Cem\u003Eload\u003C\u002Fem\u003E, yaudah, rusak deh. Kurang lebih penampakan errornya (di Firefox) kayak gini:\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Cimg src=\"\u002Fimages\u002Fposts\u002Fss-csp-error.png\" alt=\"CSP Error\"\u003E\u003C\u002Fp\u003E\n\u003Cp\u003ETernyata sebelumnya dari pihak IT pusat sana, web servernya baru disetting untuk mengirimkan \u003Cem\u003Eheader\u003C\u002Fem\u003E \u003Ccode\u003EContent-Security-Policy\u003C\u002Fcode\u003E yang berisikan \u003Cem\u003Ewhitelist\u003C\u002Fem\u003E \u003Cem\u003Ehost\u003C\u002Fem\u003E mana saja yang diperbolehkan untuk di-\u003Cem\u003Eload\u003C\u002Fem\u003E oleh website-website yang berada pada server naungan mereka, dan \u003Cem\u003Ecdnjs.cloudflare.com\u003C\u002Fem\u003E serta \u003Cem\u003Eunpkg.com\u003C\u002Fem\u003E tidak terdaftar dalam \u003Cem\u003Ewhitelist\u003C\u002Fem\u003E tersebut. Karena saya cuma dikasih akses ke sebagian fitur \u003Cem\u003Ecpanel\u003C\u002Fem\u003E-nya aja, alhasil yang saya lakukan adalah mengunduh semua \u003Cem\u003Eresource\u003C\u002Fem\u003E pada \u003Cem\u003ECDN\u003C\u002Fem\u003E, dan mengunggahnya ke server mereka, lalu mengubah kode \u003Cem\u003EHTML\u003C\u002Fem\u003E dari yang tadinya load ke \u003Cem\u003EURL\u003C\u002Fem\u003E \u003Cem\u003ECDN\u003C\u002Fem\u003E menjadi load ke \u003Cem\u003EURL\u003C\u002Fem\u003E website itu sendiri.\u003C\u002Fp\u003E\n\u003Cp\u003EApa yang dilakukan IT pihak pusat memang sudah benar, yaitu mencegah potensi \u003Cem\u003EXSS\u003C\u002Fem\u003E dari berbagai website yang dikembangkan berbagai developer (dan vendor) yang hosting websitenya ke server mereka, dimana jika ada salah satu website saja \u003Cem\u003Evuln\u003C\u002Fem\u003E, maka website lain bisa terpengaruh karenanya.\u003C\u002Fp\u003E\n\u003Cp\u003ESetelah kejadian ini saya baca-baca lagi tentang \u003Cstrong\u003E\u003Cem\u003EContent-Security-Policy (CSP)\u003C\u002Fem\u003E\u003C\u002Fstrong\u003E, dan \u003Cdel\u003Esupaya menjadi manfaat\u003C\u002Fdel\u003E karena blog saya udah lama ga update, saya tulis sekalian disini.\u003C\u002Fp\u003E\n\u003Cblockquote\u003E\n\u003Cp\u003ESetelah ini saya akan singkat \u003Cstrong\u003E\u003Cem\u003EContent-Security-Policy\u003C\u002Fem\u003E\u003C\u002Fstrong\u003E menjadi \u003Cstrong\u003E\u003Cem\u003ECSP\u003C\u002Fem\u003E\u003C\u002Fstrong\u003E saja.\u003C\u002Fp\u003E\n\u003C\u002Fblockquote\u003E\n\u003Ch2 id=\"apa-itu-csp\"\u003E\u003Ca href=\"#apa-itu-csp\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003EApa itu \u003Cem\u003ECSP\u003C\u002Fem\u003E?\u003C\u002Fh2\u003E\n\u003Cp\u003E\u003Cem\u003ECSP\u003C\u002Fem\u003E adalah \u003Cem\u003EHTTP Response Header\u003C\u002Fem\u003E atau \u003Cem\u003EMeta Tag\u003C\u002Fem\u003E untuk mengatur \u003Cstrong\u003Eresource dari sumber mana saja\u003C\u002Fstrong\u003E\nyang diperbolehkan untuk dieksekusi oleh \u003Cem\u003Eweb browser\u003C\u002Fem\u003E (yang \u003Ca href=\"https:\u002F\u002Fcaniuse.com\u002F#search=CSP\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003Emendukung \u003Cem\u003ECSP\u003C\u002Fem\u003E\u003C\u002Fa\u003E tentunya).\u003C\u002Fp\u003E\n\u003Cp\u003EYang dimaksud \u003Cem\u003Eresource\u003C\u002Fem\u003E disini itu ya \u003Ca href=\"https:\u002F\u002Fen.wikipedia.org\u002Fwiki\u002FWeb_resource\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003E\u003Cem\u003Eweb resource\u003C\u002Fem\u003E\u003C\u002Fa\u003E, seperti \u003Cem\u003Ejavascript\u003C\u002Fem\u003E, \u003Cem\u003Ecss\u003C\u002Fem\u003E, \u003Cem\u003Efont\u003C\u002Fem\u003E, \u003Cem\u003Eimage\u003C\u002Fem\u003E, \u003Cem\u003Evideo\u003C\u002Fem\u003E, \u003Cem\u003Eaudio\u003C\u002Fem\u003E, dsb.\u003C\u002Fp\u003E\n\u003Cp\u003EDengan \u003Cem\u003ECSP\u003C\u002Fem\u003E kita dapat meminimalisir potensi-potensi serangan XSS pada website kita dengan memerintahkan \u003Cem\u003Ebrowser\u003C\u002Fem\u003E untuk jangan me-\u003Cem\u003Eload\u003C\u002Fem\u003E dan mengeksekusi \u003Cem\u003Eresource\u003C\u002Fem\u003E dari sumber yang tidak kita inginkan.\u003C\u002Fp\u003E\n\u003Ch2 id=\"apa-yang-bisa-kita-lakukan-dengan-csp\"\u003E\u003Ca href=\"#apa-yang-bisa-kita-lakukan-dengan-csp\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003EApa yang bisa kita lakukan dengan \u003Cem\u003ECSP\u003C\u002Fem\u003E?\u003C\u002Fh2\u003E\n\u003Cp\u003EDengan memberikan \u003Cem\u003ECSP\u003C\u002Fem\u003E ke halaman web kamu, kamu dapat:\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003EMencegah \u003Cem\u003Ebrowser\u003C\u002Fem\u003E untuk mengeksekusi \u003Cem\u003Einline script\u003C\u002Fem\u003E (\u003Cem\u003Ejavascript\u003C\u002Fem\u003E di \u003Cem\u003EHTML\u003C\u002Fem\u003E).\u003C\u002Fli\u003E\n\u003Cli\u003EMencegah \u003Cem\u003Ebrowser\u003C\u002Fem\u003E untuk mengeksekusi \u003Ccode\u003Eeval\u003C\u002Fcode\u003E.\u003C\u002Fli\u003E\n\u003Cli\u003EMencegah \u003Cem\u003Ebrowser\u003C\u002Fem\u003E untuk mengeksekusi \u003Cem\u003Einline style\u003C\u002Fem\u003E.\u003C\u002Fli\u003E\n\u003Cli\u003EMencegah \u003Cem\u003Ebrowser\u003C\u002Fem\u003E untuk mengeksekusi \u003Cem\u003Escript\u003C\u002Fem\u003E, \u003Cem\u003Ecss\u003C\u002Fem\u003E, \u003Cem\u003Efont\u003C\u002Fem\u003E, gambar, video, suara, dsb diluar host yang kita tentukan.\u003C\u002Fli\u003E\n\u003Cli\u003EMencegah \u003Cem\u003Ebrowser\u003C\u002Fem\u003E untuk submisi form yang \u003Ccode\u003Eaction\u003C\u002Fcode\u003E-nya menuju ke host yang tidak kita daftarkan.\u003C\u002Fli\u003E\n\u003Cli\u003EMencegah \u003Cem\u003Ebrowser\u003C\u002Fem\u003E untuk menjalankan \u003Cem\u003EAjax\u003C\u002Fem\u003E, maupun \u003Cem\u003EWebSocket\u003C\u002Fem\u003E diluar host yang kita tentukan.\u003C\u002Fli\u003E\n\u003Cli\u003Edll.\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Ch2 id=\"bagaimana-csp-dapat-mencegah-xss\"\u003E\u003Ca href=\"#bagaimana-csp-dapat-mencegah-xss\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003EBagaimana \u003Cem\u003ECSP\u003C\u002Fem\u003E dapat Mencegah \u003Cem\u003EXSS\u003C\u002Fem\u003E?\u003C\u002Fh2\u003E\n\u003Cp\u003ESerangan \u003Cem\u003EXSS\u003C\u002Fem\u003E umumnya berasal dari form yang disubmit oleh user, yang kemudian isian dari form tersebut di-\u003Cem\u003Erender\u003C\u002Fem\u003E ke user lain sebagai kode \u003Cem\u003EHTML\u003C\u002Fem\u003E (tidak di-\u003Cem\u003Eescaping\u003C\u002Fem\u003E).\u003C\u002Fp\u003E\n\u003Cp\u003EContoh sederhananya adalah form komentar. Misalkan ada user user memasukkan kode \u003Ccode\u003E&#x3C;script\u003Ealert('oi')&#x3C;\u002Fscript\u003E\u003C\u002Fcode\u003E pada kolom komentar,  dan \u003Cem\u003Eserver-side\u003C\u002Fem\u003E tidak melakukan \u003Cem\u003Eescaping\u003C\u002Fem\u003E terhadap komentar tersebut, yang terjadi adalah \u003Cem\u003Ebrowser\u003C\u002Fem\u003E akan mengeksekusi \u003Cem\u003Einline script\u003C\u002Fem\u003E tersebut untuk menampilkan \u003Cem\u003Ealert\u003C\u002Fem\u003E ke semua user.\u003C\u002Fp\u003E\n\u003Cp\u003EDengan \u003Cem\u003ECSP\u003C\u002Fem\u003E, kita dapat menghindari hal ini dengan cara memerintahkan browser untuk jangan eksekusi \u003Cem\u003Einline script\u003C\u002Fem\u003E melalui \u003Cem\u003Eresponse header\u003C\u002Fem\u003E ataupun \u003Cem\u003Emeta tag\u003C\u002Fem\u003E. Jadi sekalipun developer khilaf tidak melakukan \u003Cem\u003Eescaping\u003C\u002Fem\u003E, serangan \u003Cem\u003EXSS\u003C\u002Fem\u003E dapat dihindari.\u003C\u002Fp\u003E\n\u003Ch2 id=\"penulisan-csp\"\u003E\u003Ca href=\"#penulisan-csp\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003EPenulisan \u003Cem\u003ECSP\u003C\u002Fem\u003E\u003C\u002Fh2\u003E\n\u003Cp\u003ESeperti yang sudah saya bilang sebelumnya, \u003Cem\u003ECSP\u003C\u002Fem\u003E dapat kita tuliskan pada \u003Cem\u003Eresponse header\u003C\u002Fem\u003E, ataupun \u003Cem\u003Emeta tag\u003C\u002Fem\u003E.\nHanya saja, artikel yang saya baca di halaman \u003Ca href=\"https:\u002F\u002Fdevelopers.google.com\u002Fweb\u002Ffundamentals\u002Fsecurity\u002Fcsp#the_meta_tag\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003EGoogle Developers\u003C\u002Fa\u003E lebih menyarankan menggunakan \u003Cem\u003Eresponse header\u003C\u002Fem\u003E. Jadi disini saya akan mencontohkan menggunakan \u003Cem\u003Eresponse header\u003C\u002Fem\u003E saja.\u003C\u002Fp\u003E\n\u003Cp\u003EUntuk penulisan \u003Cem\u003Eheader CSP\u003C\u002Fem\u003E, formatnya adalah sebagai berikut:\u003C\u002Fp\u003E\n\u003Ccode class=\"shiki\" style=\"background: #2e3440; color: #d8dee9\"\u003EContent-Security-Policy: &lt;policy-directive-1&gt;; &lt;policy-directive-2&gt;; &lt;policy-directive-n&gt;\u003C\u002Fcode\u003E\n\u003Cp\u003ESedangkan untuk penulisan \u003Ccode\u003E&#x3C;policy-directive\u003E\u003C\u002Fcode\u003E formatnya adalah seperti ini:\u003C\u002Fp\u003E\n\u003Ccode class=\"shiki\" style=\"background: #2e3440; color: #d8dee9\"\u003E&lt;directive-a&gt; &lt;source-1&gt; &lt;source-2&gt; &lt;source-n&gt;\u003C\u002Fcode\u003E\n\u003Cp\u003ESebagai contoh, jika kita hanya memperbolehkan \u003Cem\u003Eload\u003C\u002Fem\u003E \u003Cem\u003Escript\u003C\u002Fem\u003E dan \u003Cem\u003Ecss\u003C\u002Fem\u003E dari \u003Ccode\u003Eweb-a.com\u003C\u002Fcode\u003E dan \u003Ccode\u003Eweb-b.com\u003C\u002Fcode\u003E,\nkita dapat menuliskan \u003Cem\u003ECSP\u003C\u002Fem\u003E seperti ini:\u003C\u002Fp\u003E\n\u003Ccode class=\"shiki\" style=\"background: #2e3440; color: #d8dee9\"\u003EContent-Security-Policy: script-src https:\u002F\u002Fweb-a.com https:\u002F\u002Fweb-b.com; style-src https:\u002F\u002Fweb-a.com https:\u002F\u002Fweb-b.com\u003C\u002Fcode\u003E\n\u003Cp\u003EPada contoh diatas kita menggunakan \u003Cem\u003Edirective\u003C\u002Fem\u003E \u003Ccode\u003Escript-src\u003C\u002Fcode\u003E dan \u003Ccode\u003Estyle-src\u003C\u002Fcode\u003E.\nDibawah ini adalah daftar beberapa \u003Cem\u003Edirective\u003C\u002Fem\u003E yang dapat kamu gunakan:\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Ccode\u003Econnect-src\u003C\u002Fcode\u003E: membatasi akses ajax (\u003Cem\u003EXMLHttpRequest\u003C\u002Fem\u003E), \u003Cem\u003EWebSocket\u003C\u002Fem\u003E, dan \u003Cem\u003EEventSource\u003C\u002Fem\u003E.\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ccode\u003Efont-src\u003C\u002Fcode\u003E: membatasi akses font.\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ccode\u003Eimg-src\u003C\u002Fcode\u003E: membatasi akses image.\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ccode\u003Escript-src\u003C\u002Fcode\u003E: membatasi akses script.\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ccode\u003Estyle-src\u003C\u002Fcode\u003E: membatasi akses style (css).\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ccode\u003Emedia-src\u003C\u002Fcode\u003E: membatasi akses video dan audio.\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ccode\u003Eworker-src\u003C\u002Fcode\u003E: membatasi akses service worker.\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ccode\u003Echild-src\u003C\u002Fcode\u003E: membatasi akses iframe dan worker.\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ccode\u003Eform-action\u003C\u002Fcode\u003E: membatasi \u003Ccode\u003Eaction\u003C\u002Fcode\u003E dari form.\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ccode\u003Edefault-src\u003C\u002Fcode\u003E: kalau kamu malas jabarkan satu-persatu, kamu bisa gunakan ini untuk membatasi semua hal diatas.\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Cp\u003EDaftar diatas bisa saja bertambah atau berubah suatu saat, untuk itu, selebihnya bisa kamu pelajari sendiri pada artikel \u003Ca href=\"https:\u002F\u002Fdevelopers.google.com\u002Fweb\u002Ffundamentals\u002Fsecurity\u002Fcsp#policy_applies_to_a_wide_variety_of_resources\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003E\u003Cem\u003ECSP\u003C\u002Fem\u003E di Google Developers\u003C\u002Fa\u003E atau panduan \u003Ca href=\"https:\u002F\u002Fdeveloper.mozilla.org\u002Fen-US\u002Fdocs\u002FWeb\u002FHTTP\u002FHeaders\u002FContent-Security-Policy#Directives\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003E\u003Cem\u003ECSP\u003C\u002Fem\u003E di MDN\u003C\u002Fa\u003E.\u003C\u002Fp\u003E\n\u003Cp\u003ESelanjutnya, selain mendaftarkan \u003Cem\u003Ehost\u003C\u002Fem\u003E apa saja yang diperbolehkan, \u003Cem\u003ECSP\u003C\u002Fem\u003E juga memiliki beberapa keyword yang dapat kamu gunakan sebagai \u003Ccode\u003E&#x3C;source\u003E\u003C\u002Fcode\u003E seperti dibawah ini:\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Ccode\u003E'self'\u003C\u002Fcode\u003E: untuk memperbolehkan \u003Cem\u003Ebrowser\u003C\u002Fem\u003E load resource dari domain yang sama dengan website di-\u003Cem\u003Eload\u003C\u002Fem\u003E.\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ccode\u003E'unsafe-inline'\u003C\u002Fcode\u003E: untuk memperbolehkan \u003Cem\u003Ebrowser\u003C\u002Fem\u003E mengeksekusi \u003Cem\u003Einline script\u003C\u002Fem\u003E ataupun \u003Cem\u003Einline style\u003C\u002Fem\u003E.\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ccode\u003E'unsafe-eval'\u003C\u002Fcode\u003E: untuk memperbolehkan \u003Cem\u003Ebrowser\u003C\u002Fem\u003E mengeksekusi fungsi javascript \u003Ccode\u003Eeval\u003C\u002Fcode\u003E.\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ccode\u003E'none'\u003C\u002Fcode\u003E: jika kamu tidak memperbolehkan \u003Cem\u003Ebrowser\u003C\u002Fem\u003E load resource dari sumber manapun.\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Cblockquote\u003E\n\u003Cp\u003EKeyword diatas harus kamu tulis dengan menyertakan tanda petik tunggal.\u003C\u002Fp\u003E\n\u003C\u002Fblockquote\u003E\n\u003Ch2 id=\"contoh-penerapan-csp\"\u003E\u003Ca href=\"#contoh-penerapan-csp\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003EContoh Penerapan \u003Cem\u003ECSP\u003C\u002Fem\u003E\u003C\u002Fh2\u003E\n\u003Cp\u003EPada bagian ini saya menuliskan contoh-contoh \u003Cem\u003ECSP\u003C\u002Fem\u003E umum yang mungkin banyak orang butuhkan.\nDisini dimisalkan saya \u003Cem\u003Ehost\u003C\u002Fem\u003E halaman-halaman contoh ini pada \u003Ccode\u003Ehttps:\u002F\u002Fwww.emsifa.com\u003C\u002Fcode\u003E.\u003C\u002Fp\u003E\n\u003Cblockquote\u003E\n\u003Cp\u003EDisini saya akan menggunakan PHP supaya lebih ringkas aja.\u003C\u002Fp\u003E\n\u003C\u002Fblockquote\u003E\n\u003Ch4 id=\"1-memperbolehkan-semua-jenis-resource-dari-domain-yang-sama\"\u003E\u003Ca href=\"#1-memperbolehkan-semua-jenis-resource-dari-domain-yang-sama\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003E1. Memperbolehkan Semua Jenis Resource dari Domain yang Sama\u003C\u002Fh4\u003E\n\u003Cp\u003EDari kebutuhan diatas, kita dapat terjemahkan menjadi:\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003ESemua Jenis Resource: \u003Ccode\u003Edefault-src\u003C\u002Fcode\u003E\u003C\u002Fli\u003E\n\u003Cli\u003EDari Domain yang Sama: \u003Ccode\u003E'self'\u003C\u002Fcode\u003E\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Cp\u003EJadi penerapan \u003Cem\u003ECSP\u003C\u002Fem\u003E-nya adalah sebagai berikut:\u003C\u002Fp\u003E\n\u003Cpre class=\"shiki\" style=\"background-color: #191d21\"\u003E\u003Ccode\u003E\u003Cspan style=\"color: #EFEFEF\"\u003E&lt;?php\u003C\u002Fspan\u003E\n\n\u003Cspan style=\"color: #EFEFEF\"\u003E&gt;\u003C\u002Fspan\u003E\u003Cspan style=\"color: #FAC863\"\u003Eheader\u003C\u002Fspan\u003E\u003Cspan style=\"color: #FFFFFF\"\u003E(\u003C\u002Fspan\u003E\u003Cspan style=\"color: #50E3C2\"\u003E\"Content-Security-Policy: default-src 'self'\"\u003C\u002Fspan\u003E\u003Cspan style=\"color: #FFFFFF\"\u003E)\u003C\u002Fspan\u003E\u003Cspan style=\"color: #EFEFEF\"\u003E;\u003C\u002Fspan\u003E\n\n\u003Cspan style=\"color: #EFEFEF\"\u003E?&gt;\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #2BA8FF\"\u003E&lt;html&gt;\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #2BA8FF\"\u003E&lt;body&gt;\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #FFFFFF\"\u003E  \u003C\u002Fspan\u003E\u003Cspan style=\"color: #2BA8FF\"\u003E&lt;script\u003C\u002Fspan\u003E\u003Cspan style=\"color: #FFFFFF\"\u003E \u003C\u002Fspan\u003E\u003Cspan style=\"color: #FAC863\"\u003Esrc\u003C\u002Fspan\u003E\u003Cspan style=\"color: #FFFFFF\"\u003E=\u003C\u002Fspan\u003E\u003Cspan style=\"color: #50E3C2\"\u003E\"https:\u002F\u002Fwww.emsifa.com\u002Fjs\u002Fapp.js\"\u003C\u002Fspan\u003E\u003Cspan style=\"color: #2BA8FF\"\u003E&gt;&lt;\u002Fscript&gt;\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #FFFFFF\"\u003E  \u003C\u002Fspan\u003E\u003Cspan style=\"color: #2BA8FF\"\u003E&lt;script\u003C\u002Fspan\u003E\u003Cspan style=\"color: #FFFFFF\"\u003E \u003C\u002Fspan\u003E\u003Cspan style=\"color: #FAC863\"\u003Esrc\u003C\u002Fspan\u003E\u003Cspan style=\"color: #FFFFFF\"\u003E=\u003C\u002Fspan\u003E\u003Cspan style=\"color: #50E3C2\"\u003E\"https:\u002F\u002Fcdnjs.cloudflare.com\u002Fjquery\u002Fjquery.min.js\"\u003C\u002Fspan\u003E\u003Cspan style=\"color: #2BA8FF\"\u003E&gt;&lt;\u002Fscript&gt;\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #FFFFFF\"\u003E  \u003C\u002Fspan\u003E\u003Cspan style=\"color: #2BA8FF\"\u003E&lt;script&gt;alert\u003C\u002Fspan\u003E\u003Cspan style=\"color: #FFFFFF\"\u003E(\u003C\u002Fspan\u003E\u003Cspan style=\"color: #50E3C2\"\u003E'hello'\u003C\u002Fspan\u003E\u003Cspan style=\"color: #FFFFFF\"\u003E)\u003C\u002Fspan\u003E\u003Cspan style=\"color: #2BA8FF\"\u003E&lt;\u002Fscript&gt;\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #2BA8FF\"\u003E&lt;\u002Fbody&gt;\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #2BA8FF\"\u003E&lt;\u002Fhtml&gt;\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003EPada contoh diatas, script \u003Ccode\u003Eapp.js\u003C\u002Fcode\u003E akan di-\u003Cem\u003Eload\u003C\u002Fem\u003E dan dieksekusi oleh browser, sedangkan script jQuery tidak akan dieksekusi karena berada pada host \u003Ccode\u003Ecdnjs.cloudflare.com\u003C\u002Fcode\u003E, dan script \u003Ccode\u003Ealert('hello')\u003C\u002Fcode\u003E dibawahnya juga tidak akan dieksekusi karena kita tidak mendaftarkan \u003Ccode\u003E'unsafe-inline'\u003C\u002Fcode\u003E pada header CSP.\u003C\u002Fp\u003E\n\u003Ch4 id=\"2-memperbolehkan-semua-jenis-resource-dari-sumber-yang-sama-dan-cdnjs\"\u003E\u003Ca href=\"#2-memperbolehkan-semua-jenis-resource-dari-sumber-yang-sama-dan-cdnjs\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003E2. Memperbolehkan Semua Jenis Resource dari Sumber yang Sama dan CDN.js\u003C\u002Fh4\u003E\n\u003Cp\u003EDari kebutuhan diatas, kalau kita terjemahkan kedalam CSP, menjadi:\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003ESemua Jenis Resource: \u003Ccode\u003Edefault-src\u003C\u002Fcode\u003E\u003C\u002Fli\u003E\n\u003Cli\u003ESumber yang sama dan CDN.js: \u003Ccode\u003E'self' https:\u002F\u002Fcdnjs.cloudflare.com\u003C\u002Fcode\u003E\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Cp\u003EKalau kita terapkan ke \u003Cem\u003ECSP\u003C\u002Fem\u003E akan menjadi:\u003C\u002Fp\u003E\n\u003Cpre class=\"shiki\" style=\"background-color: #191d21\"\u003E\u003Ccode\u003E\u003Cspan style=\"color: #EFEFEF\"\u003E&lt;?php\u003C\u002Fspan\u003E\n\n\u003Cspan style=\"color: #EFEFEF\"\u003E&gt;\u003C\u002Fspan\u003E\u003Cspan style=\"color: #FAC863\"\u003Eheader\u003C\u002Fspan\u003E\u003Cspan style=\"color: #FFFFFF\"\u003E(\u003C\u002Fspan\u003E\u003Cspan style=\"color: #50E3C2\"\u003E\"Content-Security-Policy: default-src 'self' https:\u002F\u002Fcdnjs.cloudflare.com\"\u003C\u002Fspan\u003E\u003Cspan style=\"color: #FFFFFF\"\u003E)\u003C\u002Fspan\u003E\u003Cspan style=\"color: #EFEFEF\"\u003E;\u003C\u002Fspan\u003E\n\n\u003Cspan style=\"color: #EFEFEF\"\u003E?&gt;\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #2BA8FF\"\u003E&lt;html&gt;\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #2BA8FF\"\u003E&lt;body&gt;\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #FFFFFF\"\u003E  \u003C\u002Fspan\u003E\u003Cspan style=\"color: #2BA8FF\"\u003E&lt;script\u003C\u002Fspan\u003E\u003Cspan style=\"color: #FFFFFF\"\u003E \u003C\u002Fspan\u003E\u003Cspan style=\"color: #FAC863\"\u003Esrc\u003C\u002Fspan\u003E\u003Cspan style=\"color: #FFFFFF\"\u003E=\u003C\u002Fspan\u003E\u003Cspan style=\"color: #50E3C2\"\u003E\"https:\u002F\u002Fwww.emsifa.com\u002Fjs\u002Fapp.js\"\u003C\u002Fspan\u003E\u003Cspan style=\"color: #2BA8FF\"\u003E&gt;&lt;\u002Fscript&gt;\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #FFFFFF\"\u003E  \u003C\u002Fspan\u003E\u003Cspan style=\"color: #2BA8FF\"\u003E&lt;script\u003C\u002Fspan\u003E\u003Cspan style=\"color: #FFFFFF\"\u003E \u003C\u002Fspan\u003E\u003Cspan style=\"color: #FAC863\"\u003Esrc\u003C\u002Fspan\u003E\u003Cspan style=\"color: #FFFFFF\"\u003E=\u003C\u002Fspan\u003E\u003Cspan style=\"color: #50E3C2\"\u003E\"https:\u002F\u002Fcdnjs.cloudflare.com\u002Fjquery\u002Fjquery.min.js\"\u003C\u002Fspan\u003E\u003Cspan style=\"color: #2BA8FF\"\u003E&gt;&lt;\u002Fscript&gt;\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #FFFFFF\"\u003E  \u003C\u002Fspan\u003E\u003Cspan style=\"color: #2BA8FF\"\u003E&lt;script&gt;alert\u003C\u002Fspan\u003E\u003Cspan style=\"color: #FFFFFF\"\u003E(\u003C\u002Fspan\u003E\u003Cspan style=\"color: #50E3C2\"\u003E'hello'\u003C\u002Fspan\u003E\u003Cspan style=\"color: #FFFFFF\"\u003E)\u003C\u002Fspan\u003E\u003Cspan style=\"color: #2BA8FF\"\u003E&lt;\u002Fscript&gt;\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #2BA8FF\"\u003E&lt;\u002Fbody&gt;\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #2BA8FF\"\u003E&lt;\u002Fhtml&gt;\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003EPada contoh diatas, \u003Ccode\u003Eapp.js\u003C\u002Fcode\u003E dan jQuery akan di-\u003Cem\u003Eload\u003C\u002Fem\u003E oleh \u003Cem\u003Ebrowser\u003C\u002Fem\u003E, sedangkan script \u003Ccode\u003Ealert('hello')\u003C\u002Fcode\u003E tetap diblokir oleh \u003Cem\u003Ebrowser\u003C\u002Fem\u003E.\u003C\u002Fp\u003E\n\u003Ch4 id=\"3-hanya-memperbolehkan-script-css-dan-image-dari-hosting-sendiri-tidak-memperbolehkan-video-dan-audio-apapun-tapi-memperbolehkan-embed-video-youtube\"\u003E\u003Ca href=\"#3-hanya-memperbolehkan-script-css-dan-image-dari-hosting-sendiri-tidak-memperbolehkan-video-dan-audio-apapun-tapi-memperbolehkan-embed-video-youtube\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003E3. Hanya Memperbolehkan \u003Cem\u003EScript\u003C\u002Fem\u003E, \u003Cem\u003ECSS\u003C\u002Fem\u003E, dan \u003Cem\u003EImage\u003C\u002Fem\u003E dari \u003Cem\u003EHosting\u003C\u002Fem\u003E Sendiri, tidak Memperbolehkan Video dan Audio Apapun, tapi memperbolehkan Embed Video Youtube\u003C\u002Fh4\u003E\n\u003Cp\u003EOke, kita coba terjemahkan dulu kebutuhan diatas:\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003EHanya Memperbolehkan Script CSS dan Image dari Hosting sendiri: artinya kita memerlukan 3 buah directive yaitu \u003Ccode\u003Escript-src\u003C\u002Fcode\u003E, \u003Ccode\u003Estyle-src\u003C\u002Fcode\u003E, dan \u003Ccode\u003Eimg-src\u003C\u002Fcode\u003E yang memperbolehkan \u003Ccode\u003E'self'\u003C\u002Fcode\u003E.\u003C\u002Fli\u003E\n\u003Cli\u003ETidak memperbolehkan Video dan Audio Apapun: artinya kita perlu menuliskan directive \u003Ccode\u003Emedia-src\u003C\u002Fcode\u003E menjadi \u003Ccode\u003E'none'\u003C\u002Fcode\u003E.\u003C\u002Fli\u003E\n\u003Cli\u003ETapi memperbolehkan Embed Video Youtube: artinya kita perlu menuliskan directive \u003Ccode\u003Echild-src\u003C\u002Fcode\u003E ke \u003Ccode\u003Ehttps:\u002F\u002Fyoutube.com\u003C\u002Fcode\u003E.\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Cp\u003EKalau kita terapkan ke header \u003Cem\u003ECSP\u003C\u002Fem\u003E menjadi seperti ini:\u003C\u002Fp\u003E\n\u003Cpre class=\"shiki\" style=\"background-color: #191d21\"\u003E\u003Ccode\u003E\u003Cspan style=\"color: #EFEFEF\"\u003E&lt;?php\u003C\u002Fspan\u003E\n\n\u003Cspan style=\"color: #EFEFEF\"\u003E&gt;\u003C\u002Fspan\u003E\u003Cspan style=\"color: #FAC863\"\u003Eheader\u003C\u002Fspan\u003E\u003Cspan style=\"color: #FFFFFF\"\u003E(\u003C\u002Fspan\u003E\u003Cspan style=\"color: #50E3C2\"\u003E\"Content-Security-Policy: script-src 'self'; style-src 'self'; img-src: 'self'; media-src 'none'; child-src https:\u002F\u002Fyoutube.com\"\u003C\u002Fspan\u003E\u003Cspan style=\"color: #FFFFFF\"\u003E)\u003C\u002Fspan\u003E\u003Cspan style=\"color: #EFEFEF\"\u003E;\u003C\u002Fspan\u003E\n\n\u003Cspan style=\"color: #EFEFEF\"\u003E?&gt;\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #2BA8FF\"\u003E&lt;html&gt;\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #2BA8FF\"\u003E&lt;head&gt;\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #FFFFFF\"\u003E  \u003C\u002Fspan\u003E\u003Cspan style=\"color: #2BA8FF\"\u003E&lt;link\u003C\u002Fspan\u003E\u003Cspan style=\"color: #FFFFFF\"\u003E \u003C\u002Fspan\u003E\u003Cspan style=\"color: #FAC863\"\u003Erel\u003C\u002Fspan\u003E\u003Cspan style=\"color: #FFFFFF\"\u003E=\u003C\u002Fspan\u003E\u003Cspan style=\"color: #50E3C2\"\u003E\"stylesheet\"\u003C\u002Fspan\u003E\u003Cspan style=\"color: #FFFFFF\"\u003E \u003C\u002Fspan\u003E\u003Cspan style=\"color: #FAC863\"\u003Ehref\u003C\u002Fspan\u003E\u003Cspan style=\"color: #FFFFFF\"\u003E=\u003C\u002Fspan\u003E\u003Cspan style=\"color: #50E3C2\"\u003E\"https:\u002F\u002Fwww.emsifa.com\u002Fcss\u002Fstyle.css\"\u003C\u002Fspan\u003E\u003Cspan style=\"color: #2BA8FF\"\u003E\u002F&gt;\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #FFFFFF\"\u003E  \u003C\u002Fspan\u003E\u003Cspan style=\"color: #2BA8FF\"\u003E&lt;link\u003C\u002Fspan\u003E\u003Cspan style=\"color: #FFFFFF\"\u003E \u003C\u002Fspan\u003E\u003Cspan style=\"color: #FAC863\"\u003Erel\u003C\u002Fspan\u003E\u003Cspan style=\"color: #FFFFFF\"\u003E=\u003C\u002Fspan\u003E\u003Cspan style=\"color: #50E3C2\"\u003E\"stylesheet\"\u003C\u002Fspan\u003E\u003Cspan style=\"color: #FFFFFF\"\u003E \u003C\u002Fspan\u003E\u003Cspan style=\"color: #FAC863\"\u003Ehref\u003C\u002Fspan\u003E\u003Cspan style=\"color: #FFFFFF\"\u003E=\u003C\u002Fspan\u003E\u003Cspan style=\"color: #50E3C2\"\u003E\"https:\u002F\u002Fcdnjs.cloudflare.com\u002Fbootstrap\u002Fcss\u002Fbootstrap.min.css\"\u003C\u002Fspan\u003E\u003Cspan style=\"color: #2BA8FF\"\u003E\u002F&gt;\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #FFFFFF\"\u003E  \u003C\u002Fspan\u003E\u003Cspan style=\"color: #2BA8FF\"\u003E&lt;style&gt;\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #FFFFFF\"\u003E    \u003C\u002Fspan\u003E\u003Cspan style=\"color: #2BA8FF\"\u003Eimg\u003C\u002Fspan\u003E\u003Cspan style=\"color: #FFFFFF\"\u003E \u003C\u002Fspan\u003E\u003Cspan style=\"color: #EFEFEF\"\u003E{\u003C\u002Fspan\u003E\u003Cspan style=\"color: #FFFFFF\"\u003E \u003C\u002Fspan\u003E\u003Cspan style=\"color: #2BA8FF\"\u003Ewidth\u003C\u002Fspan\u003E\u003Cspan style=\"color: #FFFFFF\"\u003E:\u003C\u002Fspan\u003E\u003Cspan style=\"color: #9FBDE0\"\u003E \u003C\u002Fspan\u003E\u003Cspan style=\"color: #2BA8FF\"\u003E100\u003C\u002Fspan\u003E\u003Cspan style=\"color: #FF0078\"\u003Epx\u003C\u002Fspan\u003E\u003Cspan style=\"color: #EFEFEF\"\u003E;\u003C\u002Fspan\u003E\u003Cspan style=\"color: #FFFFFF\"\u003E \u003C\u002Fspan\u003E\u003Cspan style=\"color: #EFEFEF\"\u003E}\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #FFFFFF\"\u003E  \u003C\u002Fspan\u003E\u003Cspan style=\"color: #2BA8FF\"\u003E&lt;\u002Fstyle&gt;\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #2BA8FF\"\u003E&lt;\u002Fhead&gt;\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #2BA8FF\"\u003E&lt;body&gt;\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #FFFFFF\"\u003E  \u003C\u002Fspan\u003E\u003Cspan style=\"color: #2BA8FF\"\u003E&lt;img\u003C\u002Fspan\u003E\u003Cspan style=\"color: #FFFFFF\"\u003E \u003C\u002Fspan\u003E\u003Cspan style=\"color: #FAC863\"\u003Esrc\u003C\u002Fspan\u003E\u003Cspan style=\"color: #FFFFFF\"\u003E=\u003C\u002Fspan\u003E\u003Cspan style=\"color: #50E3C2\"\u003E\"https:\u002F\u002Fwww.emsifa.com\u002Fimg\u002Flogo.png\"\u003C\u002Fspan\u003E\u003Cspan style=\"color: #2BA8FF\"\u003E\u002F&gt;\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #FFFFFF\"\u003E  \u003C\u002Fspan\u003E\u003Cspan style=\"color: #2BA8FF\"\u003E&lt;img\u003C\u002Fspan\u003E\u003Cspan style=\"color: #FFFFFF\"\u003E \u003C\u002Fspan\u003E\u003Cspan style=\"color: #FAC863\"\u003Esrc\u003C\u002Fspan\u003E\u003Cspan style=\"color: #FFFFFF\"\u003E=\u003C\u002Fspan\u003E\u003Cspan style=\"color: #50E3C2\"\u003E\"https:\u002F\u002Fwww.w3schools.com\u002Fimg\u002Flogo.png\"\u003C\u002Fspan\u003E\u003Cspan style=\"color: #2BA8FF\"\u003E\u002F&gt;\u003C\u002Fspan\u003E\n\n\u003Cspan style=\"color: #FFFFFF\"\u003E  \u003C\u002Fspan\u003E\u003Cspan style=\"color: #2BA8FF\"\u003E&lt;iframe\u003C\u002Fspan\u003E\u003Cspan style=\"color: #FFFFFF\"\u003E \u003C\u002Fspan\u003E\u003Cspan style=\"color: #FAC863\"\u003Ewidth\u003C\u002Fspan\u003E\u003Cspan style=\"color: #FFFFFF\"\u003E=\u003C\u002Fspan\u003E\u003Cspan style=\"color: #50E3C2\"\u003E\"560\"\u003C\u002Fspan\u003E\u003Cspan style=\"color: #FFFFFF\"\u003E \u003C\u002Fspan\u003E\u003Cspan style=\"color: #FAC863\"\u003Eheight\u003C\u002Fspan\u003E\u003Cspan style=\"color: #FFFFFF\"\u003E=\u003C\u002Fspan\u003E\u003Cspan style=\"color: #50E3C2\"\u003E\"315\"\u003C\u002Fspan\u003E\u003Cspan style=\"color: #FFFFFF\"\u003E \u003C\u002Fspan\u003E\u003Cspan style=\"color: #FAC863\"\u003Esrc\u003C\u002Fspan\u003E\u003Cspan style=\"color: #FFFFFF\"\u003E=\u003C\u002Fspan\u003E\u003Cspan style=\"color: #50E3C2\"\u003E\"https:\u002F\u002Fwww.youtube.com\u002Fembed\u002FpTGRpH2dvRM\"\u003C\u002Fspan\u003E\u003Cspan style=\"color: #FFFFFF\"\u003E \u003C\u002Fspan\u003E\u003Cspan style=\"color: #FAC863\"\u003Eframeborder\u003C\u002Fspan\u003E\u003Cspan style=\"color: #FFFFFF\"\u003E=\u003C\u002Fspan\u003E\u003Cspan style=\"color: #50E3C2\"\u003E\"0\"\u003C\u002Fspan\u003E\u003Cspan style=\"color: #FFFFFF\"\u003E \u003C\u002Fspan\u003E\u003Cspan style=\"color: #FAC863\"\u003Eallow\u003C\u002Fspan\u003E\u003Cspan style=\"color: #FFFFFF\"\u003E=\u003C\u002Fspan\u003E\u003Cspan style=\"color: #50E3C2\"\u003E\"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture\"\u003C\u002Fspan\u003E\u003Cspan style=\"color: #FFFFFF\"\u003E \u003C\u002Fspan\u003E\u003Cspan style=\"color: #FAC863\"\u003Eallowfullscreen\u003C\u002Fspan\u003E\u003Cspan style=\"color: #2BA8FF\"\u003E&gt;&lt;\u002Fiframe&gt;\u003C\u002Fspan\u003E\n\n\u003Cspan style=\"color: #FFFFFF\"\u003E  \u003C\u002Fspan\u003E\u003Cspan style=\"color: #2BA8FF\"\u003E&lt;script\u003C\u002Fspan\u003E\u003Cspan style=\"color: #FFFFFF\"\u003E \u003C\u002Fspan\u003E\u003Cspan style=\"color: #FAC863\"\u003Esrc\u003C\u002Fspan\u003E\u003Cspan style=\"color: #FFFFFF\"\u003E=\u003C\u002Fspan\u003E\u003Cspan style=\"color: #50E3C2\"\u003E\"https:\u002F\u002Fwww.emsifa.com\u002Fjs\u002Fapp.js\"\u003C\u002Fspan\u003E\u003Cspan style=\"color: #2BA8FF\"\u003E&gt;&lt;\u002Fscript&gt;\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #FFFFFF\"\u003E  \u003C\u002Fspan\u003E\u003Cspan style=\"color: #2BA8FF\"\u003E&lt;script\u003C\u002Fspan\u003E\u003Cspan style=\"color: #FFFFFF\"\u003E \u003C\u002Fspan\u003E\u003Cspan style=\"color: #FAC863\"\u003Esrc\u003C\u002Fspan\u003E\u003Cspan style=\"color: #FFFFFF\"\u003E=\u003C\u002Fspan\u003E\u003Cspan style=\"color: #50E3C2\"\u003E\"https:\u002F\u002Fcdnjs.cloudflare.com\u002Fjquery\u002Fjquery.min.js\"\u003C\u002Fspan\u003E\u003Cspan style=\"color: #2BA8FF\"\u003E&gt;&lt;\u002Fscript&gt;\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #FFFFFF\"\u003E  \u003C\u002Fspan\u003E\u003Cspan style=\"color: #2BA8FF\"\u003E&lt;script&gt;alert\u003C\u002Fspan\u003E\u003Cspan style=\"color: #FFFFFF\"\u003E(\u003C\u002Fspan\u003E\u003Cspan style=\"color: #50E3C2\"\u003E'hello'\u003C\u002Fspan\u003E\u003Cspan style=\"color: #FFFFFF\"\u003E)\u003C\u002Fspan\u003E\u003Cspan style=\"color: #2BA8FF\"\u003E&lt;\u002Fscript&gt;\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #2BA8FF\"\u003E&lt;\u002Fbody&gt;\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #2BA8FF\"\u003E&lt;\u002Fhtml&gt;\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003EDari seluruh resource pada kode HTML diatas, hasilnya adalah seperti ini:\u003C\u002Fp\u003E\n\u003Col\u003E\n\u003Cli\u003Estyle \u003Ccode\u003Ehttps:\u002F\u002Fwww.emsifa.com\u002Fcss\u002Fstyle.css\u003C\u002Fcode\u003E: ✔.\u003C\u002Fli\u003E\n\u003Cli\u003Estyle \u003Ccode\u003Ehttps:\u002F\u002Fcdnjs.cloudflare.com\u002Fbootstrap\u002Fcss\u002Fbootstrap.min.css\u003C\u002Fcode\u003E: ❌.\u003C\u002Fli\u003E\n\u003Cli\u003Einline style \u003Ccode\u003Eimg {width: 100px}\u003C\u002Fcode\u003E: ❌.\u003C\u002Fli\u003E\n\u003Cli\u003Eimage \u003Ccode\u003Ehttps:\u002F\u002Fwww.emsifa.com\u002Fimg\u002Flogo.png\u003C\u002Fcode\u003E: ✔.\u003C\u002Fli\u003E\n\u003Cli\u003Eimage \u003Ccode\u003Ehttps:\u002F\u002Fwww.w3schools.com\u002Fimg\u002Flogo.png\u003C\u002Fcode\u003E: ❌.\u003C\u002Fli\u003E\n\u003Cli\u003Eiframe \u003Ccode\u003Ehttps:\u002F\u002Fwww.youtube.com\u002Fembed\u002FpTGRpH2dvRM\u003C\u002Fcode\u003E: ✔.\u003C\u002Fli\u003E\n\u003Cli\u003Escript \u003Ccode\u003Ehttps:\u002F\u002Fwww.emsifa.com\u002Fjs\u002Fapp.js\u003C\u002Fcode\u003E: ✔.\u003C\u002Fli\u003E\n\u003Cli\u003Escript \u003Ccode\u003Ehttps:\u002F\u002Fcdnjs.cloudflare.com\u002Fjquery\u002Fjquery.min.js\u003C\u002Fcode\u003E: ❌.\u003C\u002Fli\u003E\n\u003Cli\u003Einline script \u003Ccode\u003Ealert('hello')\u003C\u002Fcode\u003E: ❌.\u003C\u002Fli\u003E\n\u003C\u002Fol\u003E\n\u003Ch2 id=\"penutup\"\u003E\u003Ca href=\"#penutup\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003EPenutup\u003C\u002Fh2\u003E\n\u003Cp\u003EJadi seperti itulah \u003Cem\u003ECSP\u003C\u002Fem\u003E, bagaimana penulisannya, serta beberapa contohnya.\nArtikel ini saya adaptasi dari 2 link dibawah ini:\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Ca href=\"https:\u002F\u002Fdevelopers.google.com\u002Fweb\u002Ffundamentals\u002Fsecurity\u002Fcsp\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003Ehttps:\u002F\u002Fdevelopers.google.com\u002Fweb\u002Ffundamentals\u002Fsecurity\u002Fcsp\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca href=\"https:\u002F\u002Fdeveloper.mozilla.org\u002Fen-US\u002Fdocs\u002FWeb\u002FHTTP\u002FHeaders\u002FContent-Security-Policy\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003Ehttps:\u002F\u002Fdeveloper.mozilla.org\u002Fen-US\u002Fdocs\u002FWeb\u002FHTTP\u002FHeaders\u002FContent-Security-Policy\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Cp\u003EYaudah, sekian dulu artikel kali ini. Semoga bermanfaat, dah ~ \u003C\u002Fp\u003E\n","description":"Gunakan CSP untuk mencegah browser eksekusi script dari sumber yang tidak diinginkan","timeToRead":7,"cover":"\u002Fimages\u002Fposts\u002Fcsp-cover.png","coverThumb":"\u002Fimages\u002Fposts\u002Fcsp-cover.png","fullscreen":false,"author":{"id":"Muhammad Syifa","title":"Muhammad Syifa","path":"\u002Fauthor\u002FMuhammad%20Syifa\u002F"},"tags":[{"id":"Web","title":"Web","path":"\u002Ftag\u002FWeb\u002F"},{"id":"XSS","title":"XSS","path":"\u002Ftag\u002FXSS\u002F"}]}},"context":{}};(function(){var s;(s=document.currentScript||document.scripts[document.scripts.length-1]).parentNode.removeChild(s);}());</script><script src="/assets/js/app.649ec608.js" defer></script><script src="/assets/js/page--src-templates-post-vue.b802386a.js" defer></script>
  </body>
</html>
