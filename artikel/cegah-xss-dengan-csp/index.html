<!DOCTYPE html>
<html data-html-server-rendered="true" lang="en" class="h-full" data-vue-tag="%7B%22lang%22:%7B%22ssr%22:%22en%22%7D,%22class%22:%7B%22ssr%22:%22h-full%22%7D%7D">
  <head>
    <title>Cegah XSS dengan Content-Security-Policy </title><meta name="gridsome:hash" content="3f4bf2c2acdd3ecda488b692f010f187723da530"><meta data-vue-tag="ssr" charset="utf-8"><meta data-vue-tag="ssr" name="generator" content="Gridsome v0.7.23"><meta data-vue-tag="ssr" data-key="viewport" name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"><meta data-vue-tag="ssr" data-key="format-detection" name="format-detection" content="telephone=no"><meta data-vue-tag="ssr" name="theme-color" content="#1a202c"><meta data-vue-tag="ssr" data-key="description" name="description" content="Gunakan CSP untuk mencegah browser eksekusi script dari sumber yang tidak diinginkan"><meta data-vue-tag="ssr" property="og:type" content="article"><meta data-vue-tag="ssr" property="og:title" content="Cegah XSS dengan Content-Security-Policy"><meta data-vue-tag="ssr" property="og:description" content="Gunakan CSP untuk mencegah browser eksekusi script dari sumber yang tidak diinginkan"><meta data-vue-tag="ssr" property="og:url" content="https://www.emsifa.com/artikel/cegah-xss-dengan-csp/"><meta data-vue-tag="ssr" property="article:published_time" content="undefined"><meta data-vue-tag="ssr" property="og:image" content="https://www.emsifa.com/images/posts/csp-cover.png"><meta data-vue-tag="ssr" name="twitter:card" content="summary_large_image"><meta data-vue-tag="ssr" name="twitter:title" content="Cegah XSS dengan Content-Security-Policy"><meta data-vue-tag="ssr" name="twitter:description" content="Gunakan CSP untuk mencegah browser eksekusi script dari sumber yang tidak diinginkan"><meta data-vue-tag="ssr" name="twitter:site" content="@cossssmin"><meta data-vue-tag="ssr" name="twitter:creator" content="@cossssmin"><meta data-vue-tag="ssr" name="twitter:image" content="/images/posts/csp-cover.png"><link data-vue-tag="ssr" rel="icon" href="data:,"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="16x16" href="/assets/static/favicon.ce0531f.74da076e48a2b4ada66099d4f12215f4.png"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="32x32" href="/assets/static/favicon.ac8d93a.74da076e48a2b4ada66099d4f12215f4.png"><link rel="preload" href="/assets/css/9.styles.5c11bc3d.css" as="style"><link rel="preload" href="/assets/js/app.7018cf29.js" as="script"><link rel="preload" href="/assets/js/page--src-templates-post-vue.c0e9f36f.js" as="script"><link rel="prefetch" href="/assets/js/11.0f98a1ef.js"><link rel="prefetch" href="/assets/js/page--src-pages-404-vue.0ce9f9ea.js"><link rel="prefetch" href="/assets/js/page--src-pages-artikel-vue.c5d0d9d8.js"><link rel="prefetch" href="/assets/js/page--src-pages-index-vue.026ad315.js"><link rel="prefetch" href="/assets/js/page--src-pages-open-sources-vue.a82ed9ec.js"><link rel="prefetch" href="/assets/js/page--src-templates-author-vue.8270f084.js"><link rel="prefetch" href="/assets/js/page--src-templates-tag-vue.77d06a93.js"><link rel="prefetch" href="/assets/js/vendors~page--src-pages-artikel-vue~page--src-pages-index-vue~page--src-pages-open-sources-vue~page-~f457dff2.6d23a2bb.js"><link rel="prefetch" href="/assets/js/vendors~page--src-templates-post-vue.8b322f2d.js"><link rel="stylesheet" href="/assets/css/9.styles.5c11bc3d.css"><noscript data-vue-tag="ssr"><style>.g-image--loading{display:none;}</style></noscript>
  </head>
  <body class="antialiased" data-vue-tag="%7B%22class%22:%7B%22ssr%22:%22antialiased%22%7D%7D">
    <div data-server-rendered="true" id="app" class="min-h-screen light"><header class="select-none mb-5 shadow-lg border-gray-200" data-v-1b58b763><div class="container m-auto max-w-3xl px-5 md:px-0 py-5" data-v-1b58b763><div class="flex" data-v-1b58b763><div class="w-10/12" data-v-1b58b763><a href="/" class="text-black w-full inline-block active" data-v-1b58b763><div class="flex" data-v-1b58b763><div class="w-auto" data-v-1b58b763><img src="/images/logo.svg" alt="Logo" class="inline" data-v-1b58b763></div><div class="w-auto ml-3 pt-2" data-v-1b58b763><h1 class="text-normal font-semibold text-gray-700" data-v-1b58b763>
                Webnya Muhammad Syifa
              </h1><h2 class="text-sm text-gray-700 text-gray-700" data-v-1b58b763>
                Ini halaman artikel
              </h2></div></div></a></div><div class="w-2/12 text-right pt-3" data-v-1b58b763><button title="Gelapin" class="
            p-2
            rounded-full
            bg-transparent
            transition-all
            focus:outline-none
           hover:bg-yellow-200" data-v-1b58b763><img src="/images/sun.svg" alt="Sun" style="width:30px;height:30px;" data-v-1b58b763><!----></button></div></div></div></header><main><header><div class="container m-auto max-w-3xl px-5 md:px-0"><div class="mx-auto pb-5 border-b border-gray-200 text-gray-700"><img alt="Cegah XSS dengan Content-Security-Policy" src="/images/posts/csp-cover.png" class="rounded-xl shadow-xl g-image"><h1 class="text-3xl sm:text-3xl leading-tight font-sans font-semibold mb-3 mt-5">
        Cegah XSS dengan Content-Security-Policy
      </h1><p class="text-sm"><time datetime="2020-01-24 11:00:00" class="capitalize">24 Januari 2020</time></p><p class="text-xs mt-2 uppercase"></p><div class="tags mt-5"><a href="/tag/Web/" class="
          inline-block
          font-sans
          font-semibold
          text-xs
          sm:text-sm
          px-2
          py-1
          mr-2
          mb-2
          rounded
          transition-color
          transition-bg
         text-gray-700 bg-gray-200 hover:text-white hover:bg-gray-700">
          Web
        </a><a href="/tag/XSS/" class="
          inline-block
          font-sans
          font-semibold
          text-xs
          sm:text-sm
          px-2
          py-1
          mr-2
          mb-2
          rounded
          transition-color
          transition-bg
         text-gray-700 bg-gray-200 hover:text-white hover:bg-gray-700">
          XSS
        </a></div></div></div></header><div class="container m-auto max-w-3xl px-5 md:px-0"><article class="pt-5 border-grey-200"><div class="markdown text-lg leading-normal text-gray-700 pb-10"><p>Kemarin lusa (1/22), saya menerima laporan dari admin website kementerian yang saya buat kalau
webnya mengalami kendala hanya menampilkan <em>preloader</em> saja. Setelah saya cek melalui <em>devtools browser</em>,
pada bagian console, saya mendapati kalau <em>browser</em> tidak diizinkan untuk me-<em>load</em> <em>javascript</em>, <em>css</em>, maupun <em>font</em> yang berasal
dari <a href="https://cdnjs.com" target="_blank" rel="nofollow noopener noreferrer">cdnjs</a> dan <a href="https://unpkg.com" target="_blank" rel="nofollow noopener noreferrer">unpkg</a>. Alhasil sebagian script yang dibutuhkan
tidak di-<em>load</em>, yaudah, rusak deh. Kurang lebih penampakan errornya (di Firefox) kayak gini:</p>
<p><img src="/images/posts/ss-csp-error.png" alt="CSP Error"></p>
<p>Ternyata sebelumnya dari pihak IT pusat sana, web servernya baru disetting untuk mengirimkan <em>header</em> <code>Content-Security-Policy</code> yang berisikan <em>whitelist</em> <em>host</em> mana saja yang diperbolehkan untuk di-<em>load</em> oleh website-website yang berada pada server naungan mereka, dan <em>cdnjs.cloudflare.com</em> serta <em>unpkg.com</em> tidak terdaftar dalam <em>whitelist</em> tersebut. Karena saya cuma dikasih akses ke sebagian fitur <em>cpanel</em>-nya aja, alhasil yang saya lakukan adalah mengunduh semua <em>resource</em> pada <em>CDN</em>, dan mengunggahnya ke server mereka, lalu mengubah kode <em>HTML</em> dari yang tadinya load ke <em>URL</em> <em>CDN</em> menjadi load ke <em>URL</em> website itu sendiri.</p>
<p>Apa yang dilakukan IT pihak pusat memang sudah benar, yaitu mencegah potensi <em>XSS</em> dari berbagai website yang dikembangkan berbagai developer (dan vendor) yang hosting websitenya ke server mereka, dimana jika ada salah satu website saja <em>vuln</em>, maka website lain bisa terpengaruh karenanya.</p>
<p>Setelah kejadian ini saya baca-baca lagi tentang <strong><em>Content-Security-Policy (CSP)</em></strong>, dan <del>supaya menjadi manfaat</del> karena blog saya udah lama ga update, saya tulis sekalian disini.</p>
<blockquote>
<p>Setelah ini saya akan singkat <strong><em>Content-Security-Policy</em></strong> menjadi <strong><em>CSP</em></strong> saja.</p>
</blockquote>
<h2 id="apa-itu-csp"><a href="#apa-itu-csp" aria-hidden="true"><span class="icon icon-link"></span></a>Apa itu <em>CSP</em>?</h2>
<p><em>CSP</em> adalah <em>HTTP Response Header</em> atau <em>Meta Tag</em> untuk mengatur <strong>resource dari sumber mana saja</strong>
yang diperbolehkan untuk dieksekusi oleh <em>web browser</em> (yang <a href="https://caniuse.com/#search=CSP" target="_blank" rel="nofollow noopener noreferrer">mendukung <em>CSP</em></a> tentunya).</p>
<p>Yang dimaksud <em>resource</em> disini itu ya <a href="https://en.wikipedia.org/wiki/Web_resource" target="_blank" rel="nofollow noopener noreferrer"><em>web resource</em></a>, seperti <em>javascript</em>, <em>css</em>, <em>font</em>, <em>image</em>, <em>video</em>, <em>audio</em>, dsb.</p>
<p>Dengan <em>CSP</em> kita dapat meminimalisir potensi-potensi serangan XSS pada website kita dengan memerintahkan <em>browser</em> untuk jangan me-<em>load</em> dan mengeksekusi <em>resource</em> dari sumber yang tidak kita inginkan.</p>
<h2 id="apa-yang-bisa-kita-lakukan-dengan-csp"><a href="#apa-yang-bisa-kita-lakukan-dengan-csp" aria-hidden="true"><span class="icon icon-link"></span></a>Apa yang Bisa Kita Lakukan dengan <em>CSP</em>?</h2>
<p>Dengan memberikan <em>CSP</em> ke halaman web kamu, kamu dapat:</p>
<ul>
<li>Mencegah <em>browser</em> untuk mengeksekusi <em>inline script</em> (<em>javascript</em> di <em>HTML</em>).</li>
<li>Mencegah <em>browser</em> untuk mengeksekusi <code>eval</code>.</li>
<li>Mencegah <em>browser</em> untuk mengeksekusi <em>inline style</em>.</li>
<li>Mencegah <em>browser</em> untuk mengeksekusi <em>script</em>, <em>css</em>, <em>font</em>, gambar, video, suara, dsb diluar host yang kita tentukan.</li>
<li>Mencegah <em>browser</em> untuk submisi form yang <code>action</code>-nya menuju ke host yang tidak kita daftarkan.</li>
<li>Mencegah <em>browser</em> untuk menjalankan <em>Ajax</em>, maupun <em>WebSocket</em> diluar host yang kita tentukan.</li>
<li>dll.</li>
</ul>
<h2 id="bagaimana-csp-dapat-mencegah-xss"><a href="#bagaimana-csp-dapat-mencegah-xss" aria-hidden="true"><span class="icon icon-link"></span></a>Bagaimana <em>CSP</em> dapat Mencegah <em>XSS</em>?</h2>
<p>Serangan <em>XSS</em> umumnya berasal dari form yang disubmit oleh user, yang kemudian isian dari form tersebut di-<em>render</em> ke user lain sebagai kode <em>HTML</em> (tidak di-<em>escaping</em>).</p>
<p>Contoh sederhananya adalah form komentar. Misalkan ada user memasukkan kode <code>&#x3C;script>alert('oi')&#x3C;/script></code> pada kolom komentar,  dan <em>server-side</em> tidak melakukan <em>escaping</em> terhadap data komentar tersebut, yang terjadi saat komentar tersebut di-<em>render</em> ke user lain adalah <em>browser</em> akan mengeksekusi <em>inline script</em>-nya dan menampilkan alert ke user.</p>
<p>Dengan <em>CSP</em>, kita dapat menghindari hal ini dengan cara memerintahkan browser untuk jangan eksekusi <em>inline script</em>, melalui <em>response header</em> ataupun <em>meta tag</em> si <em>CSP</em>. Jadi sekalipun developer khilaf tidak melakukan <em>escaping</em>, serangan <em>XSS</em> dapat dihindari.</p>
<p>Benefitnya akan sangat terasa kalau kamu punya website atau sedang mengelola server yang memiliki puluhan sampai ratusan halaman yang menampilkan data hasil inputan form didalamnya. Dengan <em>CSP</em> kamu cukup setting http server kamu (<em>nginx</em>/<em>apache</em>/dsb) untuk mengirimkan header <em>CSP</em>, dan <em>boom!</em> kamu tidak perlu lagi khawatir tentang <em>XSS</em>. Tapi sebelum melakukan ini, lebih baik kamu komunikasikan dulu hal ini ke tim developer, supaya ga ada kejadian seperti saya yang mengalami error saat production karena menggunakan <em>resource</em> dari sumber yang tidak "direstui".</p>
<h2 id="penulisan-csp"><a href="#penulisan-csp" aria-hidden="true"><span class="icon icon-link"></span></a>Penulisan <em>CSP</em></h2>
<p>Seperti yang sudah saya bilang sebelumnya, <em>CSP</em> dapat kita tuliskan pada <em>response header</em>, ataupun <em>meta tag</em>.
Hanya saja, artikel yang saya baca di halaman <a href="https://developers.google.com/web/fundamentals/security/csp#the_meta_tag" target="_blank" rel="nofollow noopener noreferrer">Google Developers</a> lebih menyarankan menggunakan <em>response header</em>. Jadi disini saya akan mencontohkan menggunakan <em>response header</em> saja.</p>
<p>Untuk penulisan <em>header CSP</em>, formatnya adalah sebagai berikut:</p>
<div class='code-container'><pre class="shiki" style="background-color: #292D3E"><code><span class="line"><span style="color: #A6ACCD">Content-Security-Policy: &lt;policy-directive-1&gt;; &lt;policy-directive-2&gt;; &lt;policy-directive-n&gt;</span></span></code></pre></div>
<p>Sedangkan untuk penulisan <code>&#x3C;policy-directive></code> formatnya adalah seperti ini:</p>
<div class='code-container'><pre class="shiki" style="background-color: #292D3E"><code><span class="line"><span style="color: #A6ACCD">&lt;directive-a&gt; &lt;source-1&gt; &lt;source-2&gt; &lt;source-n&gt;</span></span></code></pre></div>
<p>Sebagai contoh, jika kita hanya memperbolehkan <em>load</em> <em>script</em> dan <em>css</em> dari <code>web-a.com</code> dan <code>web-b.com</code>,
kita dapat menuliskan <em>CSP</em> seperti ini:</p>
<div class='code-container'><pre class="shiki" style="background-color: #292D3E"><code><span class="line"><span style="color: #A6ACCD">Content-Security-Policy: script-src https://web-a.com https://web-b.com; style-src https://web-a.com https://web-b.com</span></span></code></pre></div>
<p>Pada contoh diatas kita menggunakan <em>directive</em> <code>script-src</code> dan <code>style-src</code>.
Dibawah ini adalah daftar beberapa <em>directive</em> yang dapat kamu gunakan:</p>
<ul>
<li><code>connect-src</code>: membatasi akses ajax (<em>XMLHttpRequest</em>), <em>WebSocket</em>, dan <em>EventSource</em>.</li>
<li><code>font-src</code>: membatasi akses font.</li>
<li><code>img-src</code>: membatasi akses image.</li>
<li><code>script-src</code>: membatasi akses script.</li>
<li><code>style-src</code>: membatasi akses style (css).</li>
<li><code>media-src</code>: membatasi akses video dan audio.</li>
<li><code>worker-src</code>: membatasi akses service worker.</li>
<li><code>child-src</code>: membatasi akses iframe dan worker.</li>
<li><code>form-action</code>: membatasi <code>action</code> dari form.</li>
<li><code>default-src</code>: kalau kamu malas jabarkan satu-persatu, kamu bisa gunakan ini untuk membatasi semua hal diatas.</li>
</ul>
<p>Daftar diatas bisa saja bertambah atau berubah suatu saat, untuk itu, selebihnya bisa kamu pelajari sendiri pada artikel <a href="https://developers.google.com/web/fundamentals/security/csp#policy_applies_to_a_wide_variety_of_resources" target="_blank" rel="nofollow noopener noreferrer"><em>CSP</em> di Google Developers</a> atau panduan <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy#Directives" target="_blank" rel="nofollow noopener noreferrer"><em>CSP</em> di MDN</a>.</p>
<p>Selanjutnya, selain mendaftarkan <em>host</em> apa saja yang diperbolehkan, <em>CSP</em> juga memiliki beberapa keyword yang dapat kamu gunakan sebagai <code>&#x3C;source></code> seperti dibawah ini:</p>
<ul>
<li><code>'self'</code>: untuk memperbolehkan <em>browser</em> load resource dari domain yang sama dengan website di-<em>load</em>.</li>
<li><code>'unsafe-inline'</code>: untuk memperbolehkan <em>browser</em> mengeksekusi <em>inline script</em> ataupun <em>inline style</em>.</li>
<li><code>'unsafe-eval'</code>: untuk memperbolehkan <em>browser</em> mengeksekusi fungsi javascript <code>eval</code>.</li>
<li><code>'none'</code>: jika kamu tidak memperbolehkan <em>browser</em> load resource dari sumber manapun.</li>
</ul>
<blockquote>
<p>Keyword diatas harus kamu tulis dengan menyertakan tanda petik tunggal.</p>
</blockquote>
<h2 id="contoh-penerapan-csp"><a href="#contoh-penerapan-csp" aria-hidden="true"><span class="icon icon-link"></span></a>Contoh Penerapan <em>CSP</em></h2>
<p>Pada bagian ini saya menuliskan contoh-contoh <em>CSP</em> umum yang mungkin banyak orang butuhkan.
Disini dimisalkan saya <em>host</em> halaman-halaman contoh ini pada <code>https://www.emsifa.com</code>.</p>
<blockquote>
<p>Disini saya akan menggunakan PHP supaya lebih ringkas aja.</p>
</blockquote>
<h4 id="1-memperbolehkan-semua-jenis-resource-dari-domain-yang-sama"><a href="#1-memperbolehkan-semua-jenis-resource-dari-domain-yang-sama" aria-hidden="true"><span class="icon icon-link"></span></a>1. Memperbolehkan Semua Jenis Resource dari Domain yang Sama</h4>
<p>Dari kebutuhan diatas, kita dapat terjemahkan menjadi:</p>
<ul>
<li>Semua Jenis Resource: <code>default-src</code></li>
<li>Dari Domain yang Sama: <code>'self'</code></li>
</ul>
<p>Jadi penerapan <em>CSP</em>-nya adalah sebagai berikut:</p>
<div class='code-container'><div class="code-metadata " filename="contoh-1.php" highlight="2">contoh-1.php</div><pre class="shiki" style="background-color: #292D3E"><code><span class="line"><span style="color: #89DDFF">&lt;?</span><span style="color: #A6ACCD">php</span></span>

<span class="line"><span style="color: #82AAFF">header</span><span style="color: #89DDFF">(</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">Content-Security-Policy: default-src &#39;self&#39;</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">);</span></span>

<span class="line"><span style="color: #89DDFF">?&gt;</span></span>
<span class="line"><span style="color: #89DDFF">&lt;</span><span style="color: #A6ACCD">html</span><span style="color: #89DDFF">&gt;</span></span>
<span class="line"><span style="color: #89DDFF">&lt;</span><span style="color: #A6ACCD">body</span><span style="color: #89DDFF">&gt;</span></span>
<span class="line"><span style="color: #A6ACCD">  </span><span style="color: #89DDFF">&lt;</span><span style="color: #A6ACCD">script src</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">https://www.emsifa.com/js/app.js</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">&gt;&lt;/</span><span style="color: #A6ACCD">script</span><span style="color: #89DDFF">&gt;</span></span>
<span class="line"><span style="color: #A6ACCD">  </span><span style="color: #89DDFF">&lt;</span><span style="color: #A6ACCD">script src</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">https://cdnjs.cloudflare.com/jquery/jquery.min.js</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">&gt;&lt;/</span><span style="color: #A6ACCD">script</span><span style="color: #89DDFF">&gt;</span></span>
<span class="line"><span style="color: #A6ACCD">  </span><span style="color: #89DDFF">&lt;</span><span style="color: #A6ACCD">script</span><span style="color: #89DDFF">&gt;</span><span style="color: #82AAFF">alert</span><span style="color: #89DDFF">(</span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">hello</span><span style="color: #89DDFF">&#39;</span><span style="color: #89DDFF">)&lt;/</span><span style="color: #A6ACCD">script</span><span style="color: #89DDFF">&gt;</span></span>
<span class="line"><span style="color: #89DDFF">&lt;/</span><span style="color: #A6ACCD">body</span><span style="color: #89DDFF">&gt;</span></span>
<span class="line"><span style="color: #89DDFF">&lt;/</span><span style="color: #A6ACCD">html</span><span style="color: #89DDFF">&gt;</span></span></code></pre></div>
<p>Pada contoh diatas, script <code>app.js</code> akan di-<em>load</em> dan dieksekusi oleh browser, sedangkan script jQuery tidak akan dieksekusi karena berada pada host <code>cdnjs.cloudflare.com</code>, dan script <code>alert('hello')</code> dibawahnya juga tidak akan dieksekusi karena kita tidak mendaftarkan <code>'unsafe-inline'</code> pada header CSP.</p>
<h4 id="2-memperbolehkan-semua-jenis-resource-dari-sumber-yang-sama-dan-cdnjs"><a href="#2-memperbolehkan-semua-jenis-resource-dari-sumber-yang-sama-dan-cdnjs" aria-hidden="true"><span class="icon icon-link"></span></a>2. Memperbolehkan Semua Jenis Resource dari Sumber yang Sama dan CDN.js</h4>
<p>Dari kebutuhan diatas, kalau kita terjemahkan kedalam CSP, menjadi:</p>
<ul>
<li>Semua Jenis Resource: <code>default-src</code></li>
<li>Sumber yang sama dan CDN.js: <code>'self' https://cdnjs.cloudflare.com</code></li>
</ul>
<p>Kalau kita terapkan ke <em>CSP</em> akan menjadi:</p>
<div class='code-container'><div class="code-metadata " filename="contoh-2.php" highlight="2">contoh-2.php</div><pre class="shiki" style="background-color: #292D3E"><code><span class="line"><span style="color: #89DDFF">&lt;?</span><span style="color: #A6ACCD">php</span></span>

<span class="line"><span style="color: #82AAFF">header</span><span style="color: #89DDFF">(</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">Content-Security-Policy: default-src &#39;self&#39; https://cdnjs.cloudflare.com</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">);</span></span>

<span class="line"><span style="color: #89DDFF">?&gt;</span></span>
<span class="line"><span style="color: #89DDFF">&lt;</span><span style="color: #A6ACCD">html</span><span style="color: #89DDFF">&gt;</span></span>
<span class="line"><span style="color: #89DDFF">&lt;</span><span style="color: #A6ACCD">body</span><span style="color: #89DDFF">&gt;</span></span>
<span class="line"><span style="color: #A6ACCD">  </span><span style="color: #89DDFF">&lt;</span><span style="color: #A6ACCD">script src</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">https://www.emsifa.com/js/app.js</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">&gt;&lt;/</span><span style="color: #A6ACCD">script</span><span style="color: #89DDFF">&gt;</span></span>
<span class="line"><span style="color: #A6ACCD">  </span><span style="color: #89DDFF">&lt;</span><span style="color: #A6ACCD">script src</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">https://cdnjs.cloudflare.com/jquery/jquery.min.js</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">&gt;&lt;/</span><span style="color: #A6ACCD">script</span><span style="color: #89DDFF">&gt;</span></span>
<span class="line"><span style="color: #A6ACCD">  </span><span style="color: #89DDFF">&lt;</span><span style="color: #A6ACCD">script</span><span style="color: #89DDFF">&gt;</span><span style="color: #82AAFF">alert</span><span style="color: #89DDFF">(</span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">hello</span><span style="color: #89DDFF">&#39;</span><span style="color: #89DDFF">)&lt;/</span><span style="color: #A6ACCD">script</span><span style="color: #89DDFF">&gt;</span></span>
<span class="line"><span style="color: #89DDFF">&lt;/</span><span style="color: #A6ACCD">body</span><span style="color: #89DDFF">&gt;</span></span>
<span class="line"><span style="color: #89DDFF">&lt;/</span><span style="color: #A6ACCD">html</span><span style="color: #89DDFF">&gt;</span></span></code></pre></div>
<p>Pada contoh diatas, <code>app.js</code> dan jQuery akan di-<em>load</em> oleh <em>browser</em>, sedangkan script <code>alert('hello')</code> tetap diblokir oleh <em>browser</em>.</p>
<h4 id="3-hanya-memperbolehkan-script-css-dan-image-dari-hosting-sendiri-tidak-memperbolehkan-video-dan-audio-apapun-tapi-memperbolehkan-embed-video-youtube"><a href="#3-hanya-memperbolehkan-script-css-dan-image-dari-hosting-sendiri-tidak-memperbolehkan-video-dan-audio-apapun-tapi-memperbolehkan-embed-video-youtube" aria-hidden="true"><span class="icon icon-link"></span></a>3. Hanya Memperbolehkan <em>Script</em>, <em>CSS</em>, dan <em>Image</em> dari <em>Hosting</em> Sendiri, tidak Memperbolehkan Video dan Audio Apapun, tapi memperbolehkan Embed Video Youtube</h4>
<p>Oke, kita coba terjemahkan dulu kebutuhan diatas:</p>
<ul>
<li>Hanya Memperbolehkan Script CSS dan Image dari Hosting sendiri: artinya kita memerlukan 3 buah directive yaitu <code>script-src</code>, <code>style-src</code>, dan <code>img-src</code> yang memperbolehkan <code>'self'</code>.</li>
<li>Tidak memperbolehkan Video dan Audio Apapun: artinya kita perlu menuliskan directive <code>media-src</code> menjadi <code>'none'</code>.</li>
<li>Tapi memperbolehkan Embed Video Youtube: artinya kita perlu menuliskan directive <code>child-src</code> ke <code>https://youtube.com</code>.</li>
</ul>
<p>Kalau kita terapkan ke header <em>CSP</em> menjadi seperti ini:</p>
<div class='code-container'><div class="code-metadata " filename="contoh-3.php" highlight="2">contoh-3.php</div><pre class="shiki" style="background-color: #292D3E"><code><span class="line"><span style="color: #89DDFF">&lt;?</span><span style="color: #A6ACCD">php</span></span>

<span class="line"><span style="color: #82AAFF">header</span><span style="color: #89DDFF">(</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">Content-Security-Policy: script-src &#39;self&#39;; style-src &#39;self&#39;; img-src: &#39;self&#39;; media-src &#39;none&#39;; child-src https://youtube.com</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">);</span></span>

<span class="line"><span style="color: #89DDFF">?&gt;</span></span>
<span class="line"><span style="color: #89DDFF">&lt;</span><span style="color: #A6ACCD">html</span><span style="color: #89DDFF">&gt;</span></span>
<span class="line"><span style="color: #89DDFF">&lt;</span><span style="color: #A6ACCD">head</span><span style="color: #89DDFF">&gt;</span></span>
<span class="line"><span style="color: #A6ACCD">  </span><span style="color: #89DDFF">&lt;</span><span style="color: #A6ACCD">link rel</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">stylesheet</span><span style="color: #89DDFF">&quot;</span><span style="color: #A6ACCD"> href</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">https://www.emsifa.com/css/style.css</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">/&gt;</span></span>
<span class="line"><span style="color: #A6ACCD">  </span><span style="color: #89DDFF">&lt;</span><span style="color: #A6ACCD">link rel</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">stylesheet</span><span style="color: #89DDFF">&quot;</span><span style="color: #A6ACCD"> href</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">https://cdnjs.cloudflare.com/bootstrap/css/bootstrap.min.css</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">/&gt;</span></span>
<span class="line"><span style="color: #A6ACCD">  </span><span style="color: #89DDFF">&lt;</span><span style="color: #A6ACCD">style</span><span style="color: #89DDFF">&gt;</span></span>
<span class="line"><span style="color: #A6ACCD">    img </span><span style="color: #89DDFF">{</span><span style="color: #A6ACCD"> width</span><span style="color: #89DDFF">:</span><span style="color: #A6ACCD"> </span><span style="color: #F78C6C">100</span><span style="color: #A6ACCD">px</span><span style="color: #89DDFF">;</span><span style="color: #A6ACCD"> </span><span style="color: #89DDFF">}</span></span>
<span class="line"><span style="color: #A6ACCD">  </span><span style="color: #89DDFF">&lt;/</span><span style="color: #A6ACCD">style</span><span style="color: #89DDFF">&gt;</span></span>
<span class="line"><span style="color: #89DDFF">&lt;/</span><span style="color: #A6ACCD">head</span><span style="color: #89DDFF">&gt;</span></span>
<span class="line"><span style="color: #89DDFF">&lt;</span><span style="color: #A6ACCD">body</span><span style="color: #89DDFF">&gt;</span></span>
<span class="line"><span style="color: #A6ACCD">  </span><span style="color: #89DDFF">&lt;</span><span style="color: #A6ACCD">img src</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">https://www.emsifa.com/img/logo.png</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">/&gt;</span></span>
<span class="line"><span style="color: #A6ACCD">  </span><span style="color: #89DDFF">&lt;</span><span style="color: #A6ACCD">img src</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">https://www.w3schools.com/img/logo.png</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">/&gt;</span></span>

<span class="line"><span style="color: #A6ACCD">  </span><span style="color: #89DDFF">&lt;</span><span style="color: #A6ACCD">iframe width</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">560</span><span style="color: #89DDFF">&quot;</span><span style="color: #A6ACCD"> height</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">315</span><span style="color: #89DDFF">&quot;</span><span style="color: #A6ACCD"> src</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">https://www.youtube.com/embed/pTGRpH2dvRM</span><span style="color: #89DDFF">&quot;</span><span style="color: #A6ACCD"> frameborder</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">0</span><span style="color: #89DDFF">&quot;</span><span style="color: #A6ACCD"> allow</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture</span><span style="color: #89DDFF">&quot;</span><span style="color: #A6ACCD"> allowfullscreen</span><span style="color: #89DDFF">&gt;&lt;/</span><span style="color: #A6ACCD">iframe</span><span style="color: #89DDFF">&gt;</span></span>

<span class="line"><span style="color: #A6ACCD">  </span><span style="color: #89DDFF">&lt;</span><span style="color: #A6ACCD">script src</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">https://www.emsifa.com/js/app.js</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">&gt;&lt;/</span><span style="color: #A6ACCD">script</span><span style="color: #89DDFF">&gt;</span></span>
<span class="line"><span style="color: #A6ACCD">  </span><span style="color: #89DDFF">&lt;</span><span style="color: #A6ACCD">script src</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">https://cdnjs.cloudflare.com/jquery/jquery.min.js</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">&gt;&lt;/</span><span style="color: #A6ACCD">script</span><span style="color: #89DDFF">&gt;</span></span>
<span class="line"><span style="color: #A6ACCD">  </span><span style="color: #89DDFF">&lt;</span><span style="color: #A6ACCD">script</span><span style="color: #89DDFF">&gt;</span><span style="color: #82AAFF">alert</span><span style="color: #89DDFF">(</span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">hello</span><span style="color: #89DDFF">&#39;</span><span style="color: #89DDFF">)&lt;/</span><span style="color: #A6ACCD">script</span><span style="color: #89DDFF">&gt;</span></span>
<span class="line"><span style="color: #89DDFF">&lt;/</span><span style="color: #A6ACCD">body</span><span style="color: #89DDFF">&gt;</span></span>
<span class="line"><span style="color: #89DDFF">&lt;/</span><span style="color: #A6ACCD">html</span><span style="color: #89DDFF">&gt;</span></span></code></pre></div>
<p>Dari seluruh resource pada kode HTML diatas, hasilnya adalah seperti ini:</p>
<ol>
<li>style <code>https://www.emsifa.com/css/style.css</code>: ‚úî.</li>
<li>style <code>https://cdnjs.cloudflare.com/bootstrap/css/bootstrap.min.css</code>: ‚ùå.</li>
<li>inline style <code>img {width: 100px}</code>: ‚ùå.</li>
<li>image <code>https://www.emsifa.com/img/logo.png</code>: ‚úî.</li>
<li>image <code>https://www.w3schools.com/img/logo.png</code>: ‚ùå.</li>
<li>iframe <code>https://www.youtube.com/embed/pTGRpH2dvRM</code>: ‚úî.</li>
<li>script <code>https://www.emsifa.com/js/app.js</code>: ‚úî.</li>
<li>script <code>https://cdnjs.cloudflare.com/jquery/jquery.min.js</code>: ‚ùå.</li>
<li>inline script <code>alert('hello')</code>: ‚ùå.</li>
</ol>
<h2 id="penutup"><a href="#penutup" aria-hidden="true"><span class="icon icon-link"></span></a>Penutup</h2>
<p>Jadi seperti itulah <em>CSP</em>, bagaimana penulisannya, serta beberapa contohnya.
Artikel ini saya adaptasi dari 2 link dibawah ini:</p>
<ul>
<li><a href="https://developers.google.com/web/fundamentals/security/csp" target="_blank" rel="nofollow noopener noreferrer">https://developers.google.com/web/fundamentals/security/csp</a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy" target="_blank" rel="nofollow noopener noreferrer">https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy</a></li>
</ul>
<p>Yaudah, sekian dulu artikel kali ini. Semoga bermanfaat, dah ~ </p>
</div></article></div><section class="mb-10 py-16 bg-gray-200 text-gray-700"><div class="container m-auto max-w-3xl px-5 md:px-0"><div class="flex"><div class="w-10/12 mx-auto"><h4 class="text-2xl font-semibold mb-4 -mt-4">Suka artikel ini?</h4><p class="mb-8">
          Saya biasanya share artikel-artikel terbaru via
          <strong class="text-gray-700">facebook</strong> atau <strong class="text-gray-700">fanpage foobarology</strong> saya.
          Kalau mau dapat updatenya, di add friend/like/follow aja link-link dibawah ini üòÉ
        </p><a target="_blank" rel="noopener" href="https://www.facebook.com/em.sifa" class="px-4 py-2 text-lg text-white bg-gray-600 hover:bg-blue-500 rounded">
          Facebook
        </a><a target="_blank" rel="noopener" href="https://www.facebook.com/foobarology" class="ml-3 px-4 py-2 text-lg text-white bg-gray-600 hover:bg-blue-500 rounded">
          Foobarology
        </a></div></div></div></section><footer class="text-gray-700 text-sm leading-normal flex flex-wrap justify-between mx-auto max-w-3xl px-6 sm:px-12 pb-8 sm:pb-10"><div class="w-full sm:w-1/2 mb-4 sm:mb-0 text-gray-700"><p>¬© 2019</p></div><div class="w-full sm:w-1/2"><nav><ul class="flex sm:justify-end -mx-2"><li class="px-2"><a href="/" class="text-gray-700 border-b border-transparent hover:border-gray-400 transition-border-color active">Home</a></li><li class="px-2"><a href="/sitemap.xml" class="text-gray-700 border-b border-transparent hover:border-gray-400 transition-border-color">Sitemap</a></li><li class="px-2"><a href="/feed.xml" class="text-gray-700 border-b border-transparent hover:border-gray-400 transition-border-color">RSS Feed</a></li></ul></nav></div></footer></main></div>
    <script src="/assets/js/app.7018cf29.js" defer></script><script src="/assets/js/page--src-templates-post-vue.c0e9f36f.js" defer></script>
  </body>
</html>
